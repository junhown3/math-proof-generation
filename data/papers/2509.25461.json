{
  "arxiv_id": "2509.25461",
  "title": "$p$-adic hypoerbolicity for Shimura varieties and period images",
  "authors": [
    "Benjamin Bakker",
    "Abhishek Oswal",
    "Ananth N. Shankar",
    "Zijian Yao"
  ],
  "abstract": "We prove that Shimura varieties and geometric period images satisfy a $p$-adic extension property for large enough primes $p$. More precisely, let $\\mathsf{D}^{\\times}\\subset \\mathsf{D}$ denote the inclusion of the closed punctured unit disc in the closed unit disc. Let $X$ be either a Shimura variety or a geometric period image with torsion-free level structure. Let $F$ be a discretely valued $p$-adic field containing the number field of definition of $X$, where $p$ is a large enough prime. Then, any rigid-analytic map $f: (\\mathsf{D}^{\\times})^a \\times \\mathsf{D}^b \\rightarrow X_F^{\\textrm{an}}$ defined over $F$ whose image intersects the good reduction locus of $X_F^{\\textrm{an}}$ (with respect to an integral canonical model) extends to a map $\\mathsf{D}^{a+b}\\rightarrow X_F^{\\textrm{an}}$. We note that this hypothesis is vacuous if $X$ is proper. We also deduce an application to algebraicity of rigid-analytic maps. Our methods also apply to the more general situation of the rigid generic fiber of formal schemes admitting Fontaine-Laffaile modules which satisfy certain positivity conditions.",
  "subjects": [
    "math.NT"
  ],
  "published_date": "2025-09-29T20:08:01",
  "latex_content": "\\documentclass[11pt]{article}\n\\usepackage{mathrsfs}\n\\usepackage{mathtools}\n\\usepackage{amssymb}\n\\usepackage{amsmath}\n\\usepackage{amsthm}\n\\usepackage{amscd}\n\\usepackage{commath}\n%\\usepackage{epstopdf}\n\\usepackage{enumerate}\n\\usepackage{stmaryrd}\n\\usepackage{enumitem}\n\\usepackage{hyperref}\n\\usepackage{thmtools}\n\\usepackage{listings}\n\\usepackage{tikz}\n\\usepackage{tikz-cd}\n\\usepackage{xcolor}\n\\usepackage{cleveref}\n\n%\\usepackage{dutchcal}\n%\\usepackage{mathalfa}\n\n\n\\usepackage{comment}\n\\usepackage{lipsum}\n\\usepackage{appendix}\n\\usetikzlibrary{matrix,arrows,decorations.pathmorphing}\n\\usepackage{bm}\n\n\\DeclareMathOperator{\\Vect}{\\textup{Vect}}\n\\DeclareMathOperator{\\mO}{\\mathcal{O}}\n\\DeclareMathOperator{\\mE}{\\mathcal{E}}\n\n\\usepackage{relsize} \n\\usepackage[bbgreekl]{mathbbol} \n\\DeclareSymbolFontAlphabet{\\mathbb}{AMSb} %to ensure that the meaning of \\mathbb does not change\n\\DeclareSymbolFontAlphabet{\\mathbbl}{bbold} \n\\newcommand{\\Prism}{{\\mathlarger{\\mathbbl{\\Delta}}}}\n\n\n\\renewcommand*{\\sectionautorefname}{Section}%\n\\renewcommand*{\\subsectionautorefname}{Section}%\n\\renewcommand*{\\subsubsectionautorefname}{Section}%\n\\renewcommand*{\\theoremautorefname}{Theorem}%\n%\\renewcommand*{\\lemmaautorefname}{Lemma}%\n%\\renewcommand*{\\conjectureautorefname}{Conjecture}%\n%\\renewcommand*{\\corollaryautorefname}{Corollary}%\n%\\renewcommand*{\\definitionautorefname}{Definition}%\n%\\renewcommand*{\\methodautorefname}{Method}%\n%\\renewcommand*{\\factautorefname}{Fact}%\n%\\renewcommand*{\\problemautorefname}{Problem}%\n%\\renewcommand*{\\questionautorefname}{Question}%\n%\\renewcommand*{\\exampleautorefname}{Example}%\n%\\renewcommand*{\\remarkautorefname}{Remark}%\n%\\renewcommand*{\\propositionautorefname}{Proposition}\n\n\\textwidth = 6.5 in\n\\textheight = 9 in\n\\oddsidemargin = 0.0 in\n\\evensidemargin = 0.0 in\n\\topmargin = 0.0 in\n\\headheight = 0.0 in\n\\headsep = 0.0 in\n\\parskip = 0.1cm\n\\parindent = 0.1in\n\\newtheorem{theorem}{Theorem}[section]\n\\newtheorem{lemma}[theorem]{Lemma}\n\\newtheorem{proposition}[theorem]{Proposition}\n\\newtheorem{conjecture}[theorem]{Conjecture}\n\\newtheorem{corollary}[theorem]{Corollary}\n\\newtheorem*{theorem*}{Theorem}\n\\newtheorem*{proposition*}{Proposition}\n\\newtheorem*{corollary*}{Corollary}\n\n\n\\theoremstyle{definition}\n\\newtheorem{definition}[theorem]{Definition}\n\\newtheorem{method}[theorem]{Method}\n\\newtheorem{fact}[theorem]{Fact}\n\\newtheorem{problem}[theorem]{Problem}\n\\newtheorem{question}[theorem]{Question}\n\\newtheorem{example}[theorem]{Example}\n\\newtheorem*{claim}{Claim}\n\\newtheorem*{subclaim}{Subclaim}\n\n\\theoremstyle{remark}\n\\newtheorem{remark}[theorem]{Remark}\n\n\n\\DeclareMathOperator{\\Spf}{Spf}\n\n\\newcommand{\\D}{\\mathbb{D}}\n\\newcommand{\\Dbar}{\\overline{\\mathbb{D}}}\n\\newcommand{\\B}{\\mathbb{B}}\n\\newcommand{\\N}{\\mathbb{N}}\n\\newcommand{\\Q}{\\mathbb{Q}}\n\\newcommand{\\Z}{\\mathbb{Z}}\n\\newcommand{\\PP}{\\mathbb{P}}\n\\renewcommand{\\P}{\\mathbb{P}}\n\\newcommand{\\R}{\\mathbb{R}}\n\\newcommand{\\C}{\\mathbb{C}}\n\\newcommand{\\F}{\\mathbb{F}}\n\\newcommand{\\V}{\\mathbb{V}}\n\\renewcommand{\\L}{\\mathbb{L}}\n\\newcommand{\\bL}{\\mathbb{L}}\n\\newcommand{\\Fq}{\\mathbb{F}_q}\n\\newcommand{\\Fpbar}{\\overline{\\mathbb{F}}_p}\n\n\\newcommand{\\ShimK}{\\mathrm{Sh}_\\mathsf{K}(G,\\mathbf{X})}\n\\newcommand{\\Shim}{S(G,\\mathbf{X})}\n\\newcommand{\\integralShim}{\\mathscr{S}(G,\\mathbf{X})}\n\\newcommand{\\integralShimK}{\\mathscr{S}_\\mathsf{K}(G,\\mathbf{X})}\n\\newcommand{\\barintegralShimK}{\\bar{\\mathscr{S}}_\\mathsf{K}(G,\\mathbf{X})}\n\n\\newcommand{\\integralY}{\\mathcal{Y}}\n\\newcommand{\\integralS}{\\mathscr{S}}\n\n\\newcommand{\\cL}{\\mathcal{L}}\n\n\\newcommand{\\cO}{\\mathcal{O}}\n\\newcommand{\\OK}{\\cO_K}\n\\newcommand{\\OKbreve}{\\cO_{\\Breve{K}}}\n\\newcommand{\\cF}{\\mathcal{F}}\n\\newcommand{\\cH}{\\mathcal{H}}\n\\newcommand{\\cS}{\\mathcal{S}}\n\\newcommand{\\cP}{\\mathcal{P}}\n\\newcommand{\\cZ}{\\mathcal{Z}}\n\\newcommand{\\cT}{\\mathcal{T}}\n\n\\newcommand{\\A}{\\mathbb{A}}\n\\newcommand{\\G}{\\mathscr{G}}\n\\newcommand{\\pdiv}{\\mathscr{G}}\n\\newcommand{\\hdiv}{\\mathscr{H}}\n\\newcommand{\\abvar}{\\mathscr{A}}\n\n\\DeclareMathOperator{\\isom}{\\;\\xrightarrow{\\: {}_{\\sim} \\:} \\;}\n\n\\newcommand{\\Cl}{\\mathcal{C}\\ell}\n\\newcommand{\\Ok}{\\mathcal{O}}\n\\newcommand{\\OCp}{\\mathcal{O}_{\\mathbb{C}_p}}\n\\DeclareMathOperator{\\Spec}{\\mathrm{Spec}}\n\\DeclareMathOperator{\\geom}{\\mathrm{geom}}\n\\DeclareMathOperator{\\dR}{dR}\n\\newcommand{\\et}{\\'et}\n\n\\newcommand{\\Sp}{\\mathrm{Sp}}\n\\newcommand{\\Spa}{\\mathrm{Spa}}\n\n\\newcommand{\\an}{\\mathrm{an}}\n\\newcommand{\\berk}{\\mathrm{Berk}}\n\n\\newcommand{\\oo}{{\\circ\\circ}}\n\\newcommand{\\mdr}{M_{dR}}\n\\newcommand{\\mb}{M_B}\n\\newcommand{\\mdol}{M_{Dol}}\n\\newcommand{\\Pic}{\\mathrm{Pic}}\n\\newcommand{\\Picu}{\\mathrm{Pic}^\\natural_{A^\\vee}(\\C)}\n\\newcommand{\\Gm}{\\mathbb{G}_m}\n\\newcommand{\\Gmcp}{\\mathbb{G}_{m,\\C_p}}\n\\newcommand{\\rh}{\\mathrm{RH}}\n\\newcommand{\\topo}{\\mathrm{top}}\n\\newcommand{\\glfrak}{\\mathfrak{gl}}\n\\newcommand{\\myqed}{\\rule{2pt}{1em}}\n\\newcommand{\\gal}{\\mathrm{Gal}}\n\n\\newcommand{\\Ag}{\\mathcal{A}_g}\n\\newcommand{\\Aguni}{\\underline{\\mathscr{A}}}\n\\newcommand{\\AgK}{\\mathcal{A}_{g,\\mathsf{K}}}\n\\newcommand{\\AgKbb}{\\mathcal{A}_{g,\\mathsf{K}}^\\mathrm{BB}}\n\\newcommand{\\AgKtor}{\\mathcal{A}_{g,\\mathsf{K}}^{\\mathrm{tor}}}\n\\newcommand{\\AgKpar}{\\mathcal{A}_{g,{\\mathsf{K}_\\mathrm{par}}}}\n\\newcommand{\\AgN}{\\mathcal{A}_{g,N}}\n\\newcommand{\\SV}{\\mathscr{S}}\n%\\newcommand{\\abvar}{A}\n\\newcommand{\\Ann}{\\mathsf{A}}\n\n\n\n\n\\newcommand{\\Dstar}{\\mathsf{D}^{\\times}}\n\\newcommand{\\sD}{\\mathsf{D}}\n\\newcommand{\\sK}{\\mathsf{K}}\n\\newcommand{\\sKpar}{\\mathsf{K}_{\\mathrm{par}}}\n\\newcommand{\\Dab}{\\mathsf{D}^{\\times} \\times \\mathsf{D}^b}\n\\newcommand{\\Db}{(\\mathsf{D}^\\times)^a}\n\n\\newcommand{\\hol}{\\mathrm{hol}}\n\\newcommand{\\Ddr}{D_\\mathrm{dR}}\n\\newcommand{\\Ddrlog}{D_\\mathrm{dR, log}}\n\\newcommand{\\VetQl}{V_{\\text{\\'et},\\ell}}\n\\newcommand{\\VetZl}{\\mathbb{V}_{\\text{\\'et},\\ell}}\n\\newcommand{\\VetQp}{V_{\\text{\\'et},p}}\n\\newcommand{\\VetZp}{\\mathbb{V}_{\\text{\\'et},p}}\n\\newcommand{\\Vcris}{\\mathbb{V}_\\mathrm{cris}}\n\\newcommand{\\VFL}{\\mathbb{V}_\\mathrm{FL}}\n\\newcommand{\\UetQl}{U_{\\text{\\'et},\\ell}}\n\\newcommand{\\UetZl}{\\mathbb{U}_{\\text{\\'et},\\ell}}\n\\newcommand{\\UetQp}{U_{\\text{\\'et},p}}\n\\newcommand{\\UetZp}{\\mathbb{U}_{\\text{\\'et},p}}\n\\newcommand{\\Ucris}{\\mathbb{U}_\\mathrm{cris}}\n\\newcommand{\\UFL}{\\mathbb{U}_\\mathrm{FL}}\n\n\\newcommand{\\WetZl}{\\mathbb{W}_{\\text{\\'et},\\ell}}\n\\newcommand{\\WetZp}{\\mathbb{W}_{\\text{\\'et},p}}\n\n\n\\newcommand{\\RZ}{\\mathfrak{R}\\mathfrak{Z}}\n\\newcommand{\\fA}{\\mathfrak{A}}\n\\newcommand{\\fB}{\\mathfrak{B}}\n\\newcommand{\\fC}{\\mathfrak{C}}\n\\newcommand{\\fD}{\\mathfrak{D}}\n\\newcommand{\\fX}{\\mathfrak{X}}\n\\newcommand{\\fY}{\\mathfrak{Y}}\n\\newcommand{\\fZ}{\\mathfrak{Z}}\n\n\n\\renewcommand{\\Re}{\\operatorname{Re}}\n\\renewcommand{\\Im}{\\operatorname{Im}}\n\n\\DeclareMathOperator{\\Hom}{Hom}\n\\DeclareMathOperator{\\End}{End}\n\\DeclareMathOperator{\\Aut}{Aut}\n\\DeclareMathOperator{\\Trace}{Trace}\n\\DeclareMathOperator{\\Norm}{Norm}\n\\DeclareMathOperator{\\Lie}{Lie}\n\\DeclareMathOperator{\\pgl}{PGL}\n\\DeclareMathOperator{\\gl}{GL}\n\\DeclareMathOperator{\\GSp}{GSp}\n\\DeclareMathOperator{\\Fil}{Fil}\n\\DeclareMathOperator{\\pt}{pt}\n\n\\newcommand{\\rig}{\\mathrm{rig}}\n\\DeclareMathOperator{\\Frac}{Frac}\n\\DeclareMathOperator{\\Tate}{\\mathsf{T}}\n\\DeclareMathOperator{\\Vdr}{(\\mathcal{V},\\nabla)_{\\textrm{dR}}}\n\\DeclareMathOperator{\\Udr}{(\\mathcal{U},\\nabla)_{\\textrm{dR}}}\n\n\\DeclareMathOperator{\\der}{der}\n\\DeclareMathOperator{\\ad}{ad}\n\\DeclareMathOperator{\\per}{per}\n\\newcommand{\\BB}{\\mathrm{BB}}\n\n\\newcommand{\\kbar}{\\overline{k}}\n\\newcommand{\\cris}{\\mathrm{cris}}\n\\newcommand{\\RH}{\\mathcal{R}\\mathcal{H}}\n\n\\DeclareMathOperator{\\spec}{\\mathrm{Spec}}\n\n\\DeclareMathOperator{\\Proj}{Proj}\n\\DeclareMathOperator{\\red}{red}\n\\DeclareMathOperator{\\Bl}{Bl}\n\\DeclareMathOperator{\\good}{good}\n\\DeclareMathOperator{\\bad}{bad}\n\\renewcommand{\\O}{\\mathcal{O}}\n\n\\newcommand{\\old}[1]{\\textcolor{red}{#1}}\n\\newcommand{\\new}[1]{\\textcolor{blue}{#1}}\n\n\\def\\topol{\\mathrm{top}}\n\\def\\define{\\mathrm{def}}\n\\def\\Spec{\\operatorname{Spec}}\n\\def\\reduced{\\mathrm{red}}\n\\def\\prim{\\mathrm{prim}}\n\\def\\sExt{\\cE\\mathrm{xt}\\,}\n\\def\\sHom{\\cH\\mathrm{om}\\,}\n\n%\\theoremstyle{definition}\n\n\n\\newenvironment{myremark}\n  {\\renewcommand{\\qedsymbol}{$\\blacklozenge$}%\n   \\pushQED{\\qed}\\begin{myremark/}}\n  {\\popQED\\end{myremark/}}\n  \n \\newenvironment{itemize*}\n  {\\begin{itemize}[topsep=-\\parskip+\\jot,itemsep=-\\parskip-\\jot]}\n  {\\end{itemize}}\n \n \n\\newenvironment{enumerate*}\n  {\\begin{enumerate}[label=(\\alph*),topsep=-\\parskip+\\jot,itemsep=-\\parskip-\\jot]}\n  {\\end{enumerate}}\n\n\\newenvironment{enumerate**}\n  {\\begin{enumerate}[label=(\\roman*),topsep=-\\parskip+\\jot,itemsep=-\\parskip-\\jot]}\n  {\\end{enumerate}}\n  \n\\title{$p$-adic hyperbolicity for Shimura varieties and period images}\n\\author{Benjamin Bakker, Abhishek Oswal, Ananth N. Shankar and Zijian Yao} \n\\date{\\today}\n\n\\def\\cE{\\mathcal{E}}\n\\def\\Ext{\\operatorname{Ext}}\n\\def\\img{\\operatorname{img}}\n\\def\\topol{\\mathrm{top}}\n\\def\\define{\\mathrm{def}}\n\\def\\Spec{\\operatorname{Spec}}\n\\def\\reduced{\\mathrm{red}}\n\\def\\prim{\\mathrm{prim}}\n\\def\\sExt{\\cE\\mathrm{xt}\\,}\n\\def\\sHom{\\cH\\mathrm{om}\\,}\n\n\\def\\fX{\\mathfrak{X}}\n\\def\\ff{\\mathfrak{f}}\n\\def\\fU{\\mathfrak{U}}\n\n\\begin{document}\n\\setlist[description]{font=\\normalfont\\itshape\\textbullet\\space}\n\\maketitle\n\n\n \\begin{abstract}\nWe prove that Shimura varieties and geometric period images satisfy a $p$-adic extension property for large enough primes $p$. More precisely, let $\\Dstar\\subset \\sD$ denote the inclusion of the closed punctured unit disc in the closed unit disc. Let $X$ be either a Shimura variety or a geometric period image with torsion-free level structure. Let $F$ be a discretely valued $p$-adic field containing the number field of definition of $X$, where $p$ is a large enough prime.  Then, any rigid-analytic map $f: (\\Dstar)^a \\times \\sD^b \\rightarrow X_F^{\\an}$ defined over $F$ whose image intersects the good reduction locus of $X_F^{\\an}$ (with respect to an integral canonical model) extends to a map $\\sD^{a+b}\\rightarrow X_F^{\\an}$. We note that this hypothesis is vacuous if $X$ is proper. We also deduce an application to algebraicity of rigid-analytic maps. Our methods also apply to the more general situation of the rigid generic fiber of formal schemes admitting Fontaine-Laffaile modules which satisfy certain positivity conditions.\n \\end{abstract}\n\n\\section{Introduction} \nThe purpose of this paper is to prove $p$-adic extension and algebraicity theorems for exceptional Shimura varieties and geometric period images. This result is a $p$-adic analogue of the following theorems for complex Shimura varieties that Borel (\\cite{borel}) proved in 1972: \n\\begin{theorem*}[Borel extension]\n    Let $\\ShimK$ be a Shimura variety with torsion-free level structure. Let $D$ be the complex open disc and let $D^{\\times}$ be the punctured open unit disc. Then, every holomorphic map ${D^{\\times}}^a \\times D^b \\rightarrow \\ShimK^{\\hol}$ extends to a map $D^{a+b}\\rightarrow (\\ShimK^{\\mathrm{BB}})^{\\hol}$. \n\\end{theorem*}\nAn immediate corollary of this extension result and GAGA is the following algebraicity theorem. \n\n\\begin{theorem*}[Borel algebraicity]\n    Let $\\ShimK$ be as above, and let $M$ be a complex algebraic variety. Then every holomorphic map $M^\\hol \\rightarrow \\ShimK^{\\hol}$ is the analytification of an algebraic map $M\\rightarrow \\ShimK$.\n\\end{theorem*}\n\nHere is the main theorem of this paper. \n\n\\begin{theorem}\\label{thm:introextension}\n    Let $X$ be either a Shimura variety or a geometric period image with torsion-free level structure. There exists an integer $N$ with the following property. Let $p$ be a prime that doesn't divide $N$ and suppose $F$ is a discretely valued $p$-adic field containing the field of definition of $X$. Suppose that $f: (\\Dstar)^a \\times \\sD^b \\rightarrow X_F^{\\an}$ is a rigid-analytic map defined over $F$ such that $\\Im(f)$ intersects the good-reduction locus of $X_F$. Then, $f$ extends to a map $\\sD^{a+b} \\rightarrow X_F^\\an$. \n\\end{theorem}\n\nTheorem \\ref{thm:introextension} has the following corollary. \n\\begin{theorem}\\label{thm:introalgebraicity}\n    Let $X,p$ and $F$ be as above, and let $M$ be an algebraic variety defined over $F$. Then, every rigid-analytic map $f: M^{\\an} \\rightarrow X^\\an$ defined over $F$ such that $\\Im(f)$ is contained in the good reduction locus is the analytification of an algebraic map $M \\rightarrow X$.\n\\end{theorem}\n\n\n\\begin{remark}\n    \\begin{enumerate}\n        \\item We define the good reduction locus precisely in Section \\ref{Sec: bdry}, but informally, the good reduction locus is the analytic open subspace of $X^{\\an}$ whose classical $K$-points arise as $\\cO_K$-points of a good integral model of $X$. If $X$ is proper, then the good reduction locus is all of $X^{\\an}$ and therefore the good reduction hypothesis is vacuous. We expect the theorem to hold without this hypothesis. \n\n        \\item We draw the reader's attention to the fact that the good reduction hypothesis in Theorem \\ref{thm:introextension} has the consequence that the extension of $f$ yields a map to $X$, and it is not necessary to compactify $X$. \n\n        \\item The setting of Shimura varieties of \\emph{abelian type} is addressed in \\cite{p-adic-borel-Ag}, where the authors prove $p$-adic extension and algebraicity theorems without a good reduction hypothesis and for all primes $p$. However, the extension of the map from $(\\Dstar)^a \\times \\sD^b$ is only obtained to the Baily-Borel compactification of $X$. Indeed, one may start with a map from $\\sD$ to the Baily-Borel compactification with the property that $\\Dstar$ maps to the interior and $0$ maps to the boundary. \n    \\end{enumerate}\n\\end{remark}\n\n\\subsection{Other results}\nThe proofs of Theorem \\ref{thm:introextension} and \\ref{thm:introalgebraicity} work in a more general setting than just the case of geometric period images and Shimura varieties. In order to not mire ourselves in unenlightening notation and technicalities, we will state a result that is not the most general but that is the cleanest to state. \n\n\\begin{theorem}\\label{thm: Brunebarbe}\n    Let $\\mathscr{X}$ be a smooth scheme over $W(\\Fpbar)$, and let $\\mathscr{X}^{\\rig}$ denote its rigid generic fiber. Let $\\bL/\\mathscr{X}^{\\rig}$ be a crystalline local system with $\\VFL$ the associated Fontaine-Laffaile module. Suppose that we are in one of the following two cases. \n    \\begin{enumerate}\n        \\item The Kodaira-Spencer map associated to the filtered flat bundle underlying $\\VFL$ is everywhere immersive. \n        \\item The Griffiths bundle associated to $\\VFL$ is an ample bundle on $\\mathscr{X}$. \n    \\end{enumerate}\n    Then, every map $(\\Dstar)^{a} \\times \\sD^b \\rightarrow \\mathscr{X}^{\\rig}$ extends to a map $\\sD^{a+b}\\rightarrow \\mathscr{X}^{\\rig}$ \n\\end{theorem}\n\n\\subsection{Outline of proof}\n\n\nThe main results of \\cite{p-adic-borel-Ag} proved the $p$-adic extension and algebraization results for Shimura varieties \\emph{of abelian type}  parallelling Borel's theorem in the setting of a discretely valued $p$-adic field. The strategy of \\cite{p-adic-borel-Ag} crucially uses the existence of Rapoport-Zink (\\cite{RZ}) spaces and Rapoport-Zink uniformizations of $\\Ag$. This in turn of course relies on the moduli interpretation of $\\Ag$. While there is a theory of Rapoport-Zink spaces (see \\cite{RV}) that goes beyond the setting of abelian varieties, it is not known (though it is certainly expected) that exceptional Shimura varieties admit such uniformization maps. The setting of geometric period images is even more barren, without even any expectations of $p$-adic uniformization maps. Our proof therefore sidesteps the existence Rapoport-Zink uniformizations and instead make strong use of the existence of crystalline local systems and Fontaine-Laffaile modules. \n\nThe outline of our proof is as follows.  The main step is the case of a one-dimensional disk. For brevity, we will focus on the Shimura case. We work at a prime $p$ at which $X$ has an integral canonical model (which we will denote by $\\mathscr{X}$ in the introduction)---$\\mathscr{X}$ is equipped with $\\ell$-adic local systems and a Fontaine-Laffaille module, and $X$ is equipped with a crystalline $p$-adic local system associated to the Fontaine-Laffaille module. We first prove that any map $f: \\Dstar \\rightarrow X_F^{\\an}$ has the property that $f(\\Dstar)$ is either entirely contained in the good reduction locus, or the bad reduction locus. This proof is $\\ell$-adic and follows the arguments in \\cite{p-adic-borel-Ag}, and uses a monodromy-theoretic description of the good-reduction locus proved in \\cite{PST} for exceptional Shimura varieties. By a recent result in \\cite{DY}, \nwe know that the $p$-adic local system extends to $\\sD$. We then apply the theory of prismatic $F$-crystals to show that up to shrinking $\\sD$, the $F$-crystal associated to the crystalline Galois representation $\\bL_x$ is independent of the classical point $x\\in \\sD$. Now, we write $\\Dstar$ as an increasing union of annuli $\\Ann_k$, each of which admits an integral model $\\mathfrak{A}_k$ that maps to $\\mathscr{X}$. We then generalize an argument of Oort (\\cite{oortleaves}) to show that the $F$-crystal on $\\mathscr{X}\\bmod p$ pulls back to $\\mathfrak{A}_k \\bmod p$. Finally, we use the Kodaira-Spencer map to prove that any map from a connected variety over $\\Fpbar$ to $\\mathscr{X}\\bmod p$ with the property that the $F$-crystal over $\\mathscr{X}\\bmod p$ pulls back to something constant must in fact be the constant map. We then conclude that the map from $\\Dstar$ to $X_F^\\an$ maps to a residue disc, and therefore extends by the Riemann extension theorem. \n\nTo deduce \\Cref{thm:introextension} for morphisms from polydisks $f: (\\Dstar)^a \\times \\sD^b \\rightarrow X_F^{\\an}$, we show that the existence of an extension on any one-dimensional disk implies that $f$ extends meromorphically and then use the $p$-adic Riemann--Hilbert correspondence of \\cite{DLLZ} to show that the exceptional fibers in the resolution of indeterminacies of $f$ must be contracted.  In fact, this part of the argument also  shows that the one-dimensional disk case of \\Cref{thm:introextension} without the good reduction assumption implies the polydisk case (without the good reduction assumption). \n\n\\subsection{Previous work}\nThere are several results prior (aside from Borel's work) to our work that addresses the questions of algebraicity and extension -- both in the complex and $p$-adic settings. In the complex case, \\cite{bbt-o-minimal-gaga} and \\cite{bfmt-bailyborel} prove the algebraicity and extension results  for geometric period images. \n\n\nAs earlier mentioned, \\cite{p-adic-borel-Ag} treats the case of abelian Shimura varieties for all primes $p$, without a good-reduction hypothesis. It also treats the case of the universal abelian scheme over compact Shimura varieties of Hodge type, and Rapoport-Zink spaces associated to $\\AgK$. The paper \\cite{OswalPappas} proves the $p$-adic extension theorem for local Shimura varieties. Cherry (in \\cite{Cherry}) addresses the case of genus $\\geq 2$ curves in the more general situation of $\\C_p$. Cherry-Ru (\\cite{cherry-ru}) prove a $p$-adic big Picard style theorem, and Sun (\\cite{sun-hyperbolicity-of-mg}) proves the $\\C_p$-analogue of the algebraicity theorem. \n\n\n\n\\subsection{Organization of the paper}\nIn Section \\ref{sec: setup}, we introduce various objects that live on Shimura varieties and period images. In Section \\ref{Sec: bdry}, we prove that the image of every map $\\Dstar \\rightarrow X$ must either be entirely contained in the good reduction locus or the bad reduction locus. In Section \\ref{sec: prismatic setup}, we recall results about prismatic $F$-crystals, and in Section \\ref{Sec:pointwiseconstancy} prove a crucial constancy result for $F$-crystals. In Section \\ref{sec: constancy}, we generalize work of Oort to show that a pointwise constant $F$-crystal on $\\mathbb{P}^1$ must be constant. In Section \\ref{sec: Dstar}, we prove the main theorem for $\\Dstar$, and prove the main theorem in general for \\ref{sec: higher borel}.\n\\subsection{Acknowledgements}\nWe are very grateful to Anand Patel, Jacob Tsimerman, Alex Youcis, and Xinwen Zhu for several helpful conversations. We thank Alex Youcis for pointing us to the reference \\cite{IKY}.  B. B. was partially supported by NSF grant DMS-2401383, the Institute for Advanced Study, and the Charles\nSimonyi Endowment. A. S. was partially supported by the NSF grants DMS-2338942 and DMS-2424441, and a Sloan research fellowship. B.B. and A.S. thank the IAS for their hospitality during which part of this paper was written. \n \n\\section{Notations and the general setup}\\label{sec: setup}\n\n\\subsection{The set-up for the Shimura case}\nWe follow closely the notations of \\cite{bst-integral-canonical}.\nTo recall, $(G,\\mathbf{X})$ shall denote a Shimura datum. Let $E := E(G,\\mathbf{X}) \\subset \\C$ denote the reflex field.\nWe let $V$ be the adjoint representation of $G$, a $\\Z$-lattice $\\mathbb{V}$ of $V$, and a neat compact open subgroup $\\mathsf{K} \\subset G(\\A_f)$ that stabilizes $\\mathbb{V}\\otimes \\hat{\\Z} \\subset V\\otimes_\\Q \\A_f.$ We further assume that $\\mathsf{K}$ acts trivially on $\\mathbb{V}/3\\mathbb{V}.$\nDenote by $\\ShimK$, the corresponding Shimura variety over $E$.\nAssociated to $\\mathbb{V} \\subset V$, we have a family of $\\Z_\\ell$ (respectively $\\Q_\\ell$) \\'etale local systems on $\\ShimK$ that we denote by  $\\VetZl$ (resp. $\\VetQl$.)   \nWe denote by $V_\\mathrm{dR} := (\\mathcal{V},\\nabla,F^\\bullet \\mathcal{V})$ the associated filtered flat vector bundle on $\\ShimK$ defined over $E$.  \n\nWe pick a large integer $N$ as in \\cite[Theorem 1.3]{bst-integral-canonical}, so that $\\ShimK$ admits a smooth model $\\integralShimK$ over $\\cO_E[1/N]$ and such that for all places $v$ of $E$ outside $N$, $\\integralShimK \\otimes_{\\cO_E[1/N]} \\cO_{E_v}$ is a \\emph{canonical} integral model of $\\ShimK \\otimes_E E_v$ over the ring of integers $\\cO_{E_v}$ of the $v$-adic completion $E_v$ of $E$. Furthermore, for every place $v \\nmid N$, $\\integralShimK \\otimes_{\\cO_E[1/N]} \\cO_{E_v}$ admits a log-smooth compactification over $\\cO_{E_v}$. The $\\Z_\\ell$-\\'etale local systems $\\VetZl$ on $\\ShimK \\otimes_E E_v$, extend to $\\ell$-adic \\'etale local systems on $\\integralShimK \\otimes_{\\cO_E[1/N]} \\cO_{E_v}[1/\\ell]$. We also have that for $p \\nmid N$, the restriction of $\\VetZp$ to $\\ShimK \\otimes_E E_v$ is crystalline in the sense of Faltings-Fontaine-Laffaille, where $v$ is a place of $E$ dividing $p$. By increasing $N$ if necessary, we may also assume that $\\Vdr$ spreads out to $\\integralShimK$ such that the Kodaira-Spencer map is everywhere immersive. \n\nWe shall fix henceforth a rational prime $p \\nmid N$, a place $v$ of $E$ above $p$. \nWe shall work throughout over the $p$-adic local field $K := E_v$.\nSet $\\mathscr{S} := \\integralShimK \\otimes_{\\cO_E[1/N]} \\cO_{E_v}$, and $S := \\ShimK \\otimes_E E_v.$\nBy a slight abuse of notation, we denote the pullbacks to $S$ of the local systems $\\VetQl$, $\\VetZl$ and the filtered flat vector bundle $V_\\mathrm{dR}$ also by $\\VetQl$, $\\VetZl$ and $V_\\mathrm{dR}$ respectively, and in the case $\\ell \\neq p$, their extensions to the integral canonical model $\\mathscr{S}$ shall also be denoted by the same. We let $\\VFL$ denote the Fontaine-Laffaile module associated to $\\VetZp/S$ on the formal $p$-adic completion $\\hat \\integralS$, and we let $\\V_{\\cris}$ denote the $F$-crystal on $\\integralS_p := \\integralS \\otimes_{\\cO_{E_v}} k_v$, where $k_v$ is the residue field of $\\cO_{E_v}$. Note that the filtered flat bundle underlying $\\VFL$ is just $\\Vdr$. We will sometimes use the symbol $\\bL$ to denote the $\\Z_p$-\\'etale local system $\\VetZp$ on $S$  \nWe denote by $\\ShimK^\\mathrm{BB}$ the Baily--Borel compactification of $\\ShimK$ and set $S^\\mathrm{BB} := \\ShimK^\\mathrm{BB} \\otimes_E E_v$.\n\n\n\\subsection{The set-up for geometric period images}\n\nLet $E \\subset \\C$ be a number field, $P$ a smooth, connected quasi-projective algebraic variety over $E$, and $f : Z \\rightarrow P$ a smooth, projective $E$-morphism.\nFor a fixed $m$, we have a polarizable integral variation of Hodge structures $(\\mathbb{W}_\\Z,F^\\bullet)$ with underlying $\\Z$-local system $\\mathbb{W}_\\Z := R^mf^\\hol_\\ast(\\underline{\\Z}_{Z^\\hol})$. \nDenote by $G$, the generic Mumford-Tate group of the variation.\nWe shall further assume that the variation has \\emph{neat monodromy}, which can always be arranged after passing to a finite \\'etale cover of $P$.\nWe denote by $\\mathbb{W}_{\\text{\\'et},\\ell} := R^mf^{\\text{\\'et}}_\\ast(\\underline{\\Z_\\ell})$ the associated $\\Z_\\ell$ local system on $P$, and by $W_\\mathrm{dR} := (\\mathcal{W},\\nabla, F^\\bullet)$ the filtered flat algebraic vector bundle on $P$ defined over $E$, such that $\\mathbb{W}_\\Z$ is the sheaf of flat sections of the associated analytified filtered flat bundle on $P^\\hol$.  \n\nWe denote by $Y_{/E}$ the Stein factorization of the period map associated to the variation $(\\mathbb{W}_\\Z,F^\\bullet)$, in the sense of \\cite[\\S 1.4]{bst-integral-canonical} (see also \\cite{bbt-o-minimal-gaga}). Thus, \n$Y_{/E}$ is a quasi-projective algebraic variety over $E$, and the\nassociated period map $\\phi : P_\\C^\\hol \\rightarrow \\Gamma \\backslash D$, factors as a composite $P^\\hol \\xrightarrow{g^\\hol} Y_{\\C}^\\hol \\rightarrow \\Gamma \\backslash D,$ where the morphism $Y_{\\C}^\\hol \\rightarrow \\Gamma \\backslash D$ is finite, and $P \\xrightarrow{g} Y_{/E}$ is an algebraic map defined over $E$ with geometrically connected generic fiber. There also exists a smooth partial compactification $P'$ of $P$ defined over $E$ and a proper map $P' \\rightarrow Y$, with $W_\\mathrm{dR}$, $\\mathbb{W}_{\\text{\\'et},\\ell}$ (resp. $(\\mathbb{W}_\\Z,F^\\bullet)$) extending to $P'$ (resp. $P^{\\prime,\\hol}$). \n\n\nNote that the variation $(\\mathbb{W}_\\Z,F^\\bullet)$ descends to a polarizable $\\Z$ variation of Hodge structures $(\\mathbb{V}_\\Z,F^\\bullet)$ on $Y_{\\C}^\\hol$, as do the $\\Z_\\ell$-\\'etale local systems $\\WetZl$ to $\\Z_\\ell$-\\'etale local systems $\\VetZl$ on $Y_{/E}$ (see \\cite[\\S 2.6]{bst-integral-canonical}).\nThe filtered flat bundle $W_\\mathrm{dR} = (\\mathcal{W},\\nabla,F^\\bullet)$ on $P$ descends to a filtered vector bundle on $Y_{/E}$ defined over $E$, denoted by $V_\\mathrm{dR} = (\\mathcal{V},F^\\bullet)$. \n\nThere is a finite set of places $\\Sigma$ of $E$ such that:\n\\begin{itemize}\n    \\item $Z\\rightarrow P$ spreads out to a smooth proper family over a smooth base $\\cZ \\rightarrow \\cP$ over $\\cO_{E,\\Sigma}$.\n\n    \\item $P'\\rightarrow Y$ spreads out to a proper map $\\cP' \\rightarrow \\integralY$ over $\\cO_{E,\\Sigma}$ where $\\cP'$ is a smooth partial compactification of $\\cP$. \n\n    \\item The filtered flat bundle $W_\\mathrm{dR}/P'$ and the filtered bundle $V_{\\dR}/Y$ spread out to a filtered flat bundle on $\\cP'$ and a filtered bundle on $\\integralY$.  We abusively denote the extensions by the same notation. The Griffiths bundle of $V_\\mathrm{dR}$ on $\\integralY$ is ample. \n    \\item For every prime $\\ell$, the local system $\\WetZl$ extends to an $\\ell$-adic local system on $\\cP'_{\\cO_{E,\\Sigma_\\ell}}$ where $\\Sigma_\\ell$ is the union of $\\Sigma$ and all primes of $E$ dividing $\\ell$.  We abusively denote these local system by $\\WetZl$ as well.   Likewise, the $\\Z_\\ell$-\\'etale local systems $\\VetZl$ on $Y$ extend to $\\Z_\\ell$-local systems on $\\integralY_{ \\cO_{E,\\Sigma_\\ell}}$, which we denote by the same notation.\n\n    \\item $\\mathcal{Y}$ is an integral canonical model (as in \\cite{bst-integral-canonical}) of $Y$ over $\\cO_{E,\\Sigma}$. \n\n    \\item There is a uniform stratified resolution with boundary $\\cS^j \\rightarrow \\integralY^j$ of $\\integralY$ over $\\cO_{E,\\Sigma}$ as in \\cite[Definition 4.2]{bst-integral-canonical}, and for each $j$, there is a smooth scheme $\\cT^j/\\cO_{E,\\Sigma}$ and maps $\\cT^j \\xrightarrow{t^j} \\cP'$ and $\\cT^j \\xrightarrow{q^j} \\cS^j$ as in \\cite[Section 5.2]{bst-integral-canonical}.  For the largest-dimesnional stratum $\\mathcal{Y}^m=\\mathcal{Y}$, we may assume $\\mathcal{P}'\\to \\mathcal{Y}$ factors through $\\mathcal{S}^m$, and that $\\mathcal{P}'\\to\\mathcal{S}^m$ has geometrically connected fibers.\n\n    \\item We let $\\UetZl^j$ denote the pullback of $\\VetZl|_{\\integralY^j\\times \\cO_{E,\\Sigma_\\ell}}$ to $\\cS^j \\times \\cO_{E,\\Sigma_\\ell}$, and let $\\Udr^j$ be the pullback of $V_{\\dR}|_{\\integralY^j}$---note that $\\Udr^j$ is a filtered flat bundle.\n \n\\end{itemize}\n\n  The filtered flat bundle $W_{\\mathrm{dR}}/\\cP'$ has the structure of a Fontaine-Laffaille module at a prime $v\\notin \\Sigma$ and this corresponds to the local system $\\mathbb{W}_{\\textrm{et},p}$ for $v\\mid p$ via the Faltings-Fontaine-Laffaile correspondence. There are two filtered flat bundles on $\\cS^j$---one is $\\Udr^j$, already defined. The other one is the filtered flat bundle underlying the Fontaine-Laffaille module associated to $\\UetZp^j$. We denote this Fontaine-Laffaille module by $\\UFL^j$. We note that both these filtered flat bundles become isomorphic when pulled back to $\\cT^j$.  Note however that for the largest stratum $\\mathcal{S}^m$, these two filtered flat vector bundles \\emph{are} isomorphic, since $\\mathcal{P}'\\to\\mathcal{S}^m$ has geometrically connected fibers.  \n\nHenceforth, we fix once and for all a finite place $v \\notin \\Sigma$. Let $p$ denote the rational prime below $v$. Set $K := E_v$, with ring of integers $\\cO_K$ and residue field $k$. We will let $Y, P, V_{\\dR}$ (resp. $\\integralY, \\cS, \\cT, $) etc. also denote the basechange of the corresponding objects from $E$ (resp. $\\cO_{E,\\Sigma}$) to $K$ (resp. $\\cO_K$). Note that the $p$-adic (and $\\ell$-adic) local systems on all the spaces agree under pullback. We will sometimes use the symbol $\\bL$ to denote our $p$-adic local system(s) if the base is implicit (or unimportant). \nWe denote by $Y^\\mathrm{BB}$ the Baily--Borel compactification of the period image $Y$ (see \\cite{bfmt-bailyborel}).\n%The $\\Z_p$-\\'etale local system $\\VetZp$ on $Y$ shall be denoted by $\\mathbb{L}$.\n%For $\\ell \\neq p$, the $\\Z_\\ell$-\\'etale local systems $\\VetZl$ on $Y$ extend to $\\Z_\\ell$-local systems on $\\integralY$ that we also denote by $\\VetZl$. Similarly, the filtered vector bundle $V_\\mathrm{dR}$, extends to a filtered vector bundle on $\\integralY$ which we also denote by $V_\\mathrm{dR}$. \n\n\n\n \n\n\\subsection{General notations}\n\nAs above, we fix a rational prime $p$, a $p$-adic field $K$ with ring of integers $\\cO_K$, and residue field $k$.  \n\n\nFor a complete non-archimedean field extension $F$ of $K$, rigid-analytic varieties and spaces over $F$ shall be viewed as adic spaces over $\\Spa(F,\\cO_F)$. In particular, by a rigid-analytic variety over $F$, we shall mean a quasi-separated adic space that is locally of finite type over $\\Spa(F,\\cO_F).$ \nFor an admissible formal $\\cO_F$-scheme $\\mathscr{X}/\\Spf(\\cO_F)$, we denote the associated rigid-analytic generic fiber by $\\mathscr{X}^{\\rig}$.\nFor an algebraic variety $X$ over $F$ (respectively a morphism $g : W \\rightarrow X$ of algebraic varieties over $F$), we denote by $X^\\an$ the associated rigid-analytic space over $\\Spa(F)$ (resp. by $g^\\an : W^\\an \\rightarrow X^\\an$ the associated morphism of rigid-analytic spaces over $F$). \n\nFor a complex algebraic variety $X \\rightarrow \\Spec(\\C)$ (respectively a morphism of complex algebraic varieties $g : W \\rightarrow X$) we denote the associated complex analytic space by $X^\\hol$ (respectively the associated morphism of complex analytic spaces by $g^\\hol$).  \n\n\nThe rigid-analytic closed unit disk over $F$ is denoted by $\\sD_F := \\Spa(F\\langle t \\rangle, \\cO_F\\langle t \\rangle).$ \nThe punctured closed unit disk over $F$ is $\\Dstar_F := \\sD_F \\setminus \\{t = 0\\}.$ \n\n\n\n\n\n\\section{Boundary and interior}\\label{Sec: bdry}\n\n\\begin{definition}\n    Let $X$ denote either the Shimura variety $S$ or the period image $Y$, and let $\\mathscr{X}$ denote the integral canonical model. Let $K$ be a discretely valued field with ring of integers $\\cO_K$. We say that a point $x \\in \\mathscr{X}(K)$ has good reduction if its specialization lies in the interior, i.e.  $x$ is induced by an $\\cO_K$-valued point of $\\mathscr{X}$. We say that $x$ has bad reduction otherwise. Define the \\emph{good reduction locus} $X^{\\good}$ of $X$ to be the set of points of $X^\\an$ whose mod $p$ specialization with respect to the canonical model lies in the interior. We define the bad reduction locus to be the complement in $X^\\an$ of the good reduction locus. We note that $X^{\\good}$ is an analytic open subspace of $X^\\an$.\n\n    \n\\end{definition}\n\nWe will first prove that a map $f: \\Dstar \\rightarrow X^\\an$ must either be contained entirely in the good reduction locus or the bad reduction locus where $X$ is as above. This argument appears in an old arXiv version of \\cite{bst-integral-canonical} (Lemma 6.4) (which is turn is essentially the same as the argument in the abelian case \\cite[Theorem 3.3]{p-adic-borel-Ag}) but we include it in this paper for completion. \n\n\\begin{theorem}\\label{thm: all good or all bad}\n    Let $f : \\Dstar \\rightarrow X^\\an$ be an analytic map where $X$ is as above. Then either $f(\\Dstar) \\subseteq X^{\\good}$ or $f(\\Dstar) \\subseteq (X^\\an \\setminus X^{\\good})$. \n\\end{theorem}\n\nThe following lemma is an analogue of the Neron-Ogg-Shafarevich criterion and follows directly by the arguments of \\cite[Lemma 8.4]{PST}. \n\\begin{lemma}\\label{lem: NOS}\nLet $K$ either be $\\F((t))$ or a discretely valued $p$-adic field, and let $x\\in X(K)$ be a point.  Then $x$ has bad reduction if and only if the action of the inertia subgroup $I_K \\subset \\gal_K$ on $(\\VetZl)_{x}$ is quasi-unipotent of infinite order.\n\\end{lemma}\n\n \n\\begin{proof}[Proof of \\autoref{thm: all good or all bad}]\n\\cite[Proposition 3.6]{p-adic-borel-Ag} does what is required for thin annuli. To deduce the result for thick annuli from thin annuli, we proceed along identical lines to the argument in \\cite[Section 3.1.2]{p-adic-borel-Ag}. We are reduced to proving the following result. Let $g: \\Gm \\rightarrow \\mathscr{X}_p$ be any map. Then, $g$ extends to a map $\\PP^1 \\rightarrow \\mathscr{X}_p$. To prove this, it suffices to prove that the local monodromy of $g^{-1}\\VetZl$ around the boundary points is semi-simple. To prove this, it suffices to prove that the geometric monodromy of $g^{-1}\\VetZl$ is semisimple. By \\cite[3.4.12]{Weil2}, it suffices to prove that the arithmetic local system $g^{-1}\\VetZl$ is point-wise pure---of course, this would follow from proving that $\\VetZl$ itself were pure. \n\nIn the Shimura case, this follows from the fact that $\\VetZl$ is induced by the adjoint representation of $G$, and is therefore an irreducible local system with finite determinant. In the case of geometric period maps, this follows from the fact that the local system is induced by a geometric family, and is therefore point-wise pure by \\cite{Weil2}.  \n\n\n\n\n\\end{proof}\n\n\n %%%\n %%%\n %%%\n %%%\n %%%\n\n\\section{Crystalline $p$-adic local systems and analytic prismatic $F$-crystals}\\label{sec: prismatic setup}\n \n\nIn this section, we recall the notions of crystalline local systems and $F$-crystals that are used in the article. \n\n\n\n\n\\begin{definition} \\label{def:isocrystals} Let $X/k$ be a smooth scheme. Let $X_{\\textup{crys}}$ denote the $p$-completed crystalline site of $X$,\\footnote{In this article, we shall consider the \\textit{absolute} crystalline site of $X$, or equivalently, crystalline site of $X$ over the divided power algebra $(W(k), p)$.} equipped with the structure sheaf $\\mathcal{O}_{X, \\textup{crys}}$.   %, endowed with the \\'etale topology. \n\\begin{enumerate**}\n    \\item  By a \\textit{crystal} over $X$ we mean a \\textit{finite locally free crystal} or equivalently, a \\textit{crystal of vector bundles} over $X$, that is, a sheaf of $\\mathcal{O}_{X, \\textup{crys}}$-modules $\\mathbb{E}$ such that for each PD-thickening $(U, T)$ in  $X_{\\mathrm{crys}}$, the induced Zariski sheaf $\\mathbb{E}_{T}$ is a finite locally free $\\mathcal{O}_T$-module, such that for each morphism \n    $g: (U', T') \\rightarrow (U, T)$  in $X_{\\mathrm{crys}}$, the induced map $    g^* \\mathbb{E}_T \\isom \\mathbb{E}_{T'} $ is an isomorphism. \n    \\item  An \\textit{isocrystal} over $X$ is an object in the isogeny category of  crystals of modules.  All of the isocrystals we will consider will in fact be obtained from a crystal (in vector bundles) by inverting $p$.    \n    \\item  An \\textit{$F$-crystal}  (resp. \\textit{$F$-isocrystal}) over $X$ consists of a pair $(\\mathbb{E}, \\varphi)$ where $\\mathbb{E}$ is a  crystal (resp.  isocrystal) over $X$ and $\\varphi$ is an isomorphism \n    \\[ \\varphi: F_{\\mathrm{crys}}^* \\mathbb{E} [1/p] \\isom  \\mathbb{E} [1/p] \\] which is compatible with the Frobenius map $F_{\\mathrm{crys}}$ on $\\mathcal{O}_{X, \\textup{crys}}$ induced by functoriality. \n\\end{enumerate**}\nWe write $\\Vect^{\\varphi}(X_{\\textup{crys}})$ (resp. $\\textup{Isoc}^{\\varphi}(X_{\\textup{crys}})$) for the category of $F$-crystals (resp. $F$-isocrystals) over $X$. \n\\end{definition}\n\nWe also need the notion of prismatic and analytic prismatic $F$-crystals. Let us first recall that, given a $p$-adic formal scheme $\\fX/\\mathcal{O}_K$, its absolute prismatic site $\\fX_{\\Prism}$ is the opposite of the category of bounded prisms $(A, I)$ equipped with a map $\\Spf A/I \\rightarrow \\fX$, endowed with the flat topology (on prisms). Let $\\mathcal{O}_{\\Prism}$ (resp. $\\mathcal{I}_{\\Prism}$) denote the structure sheaf (resp. the Hodge--Tate sheaf) on $\\fX_{\\Prism}$, which sends $(A, I) \\mapsto A$ (resp. sends $(A, I) \\mapsto I$). Let $\\varphi_{\\Prism}$ denote the Frobenius map on $\\mathcal{O}_{\\Prism}$. \n \n\\begin{example} \\label{Example:prisms}\n Let $E = E(u)$ be an Eisenstein polynomial for a fixed uniformizer $\\varpi \\in \\mathcal{O}_K$.  \n\\begin{enumerate}\n    \\item The \\textit{Breuil--Kisin} prism $(\\mathfrak S, E)$ with $\\mathfrak S = W (k)[\\![u]\\!]$ and $\\varphi_{\\mathfrak{S}} (u) = u^p$ gives an object in $(\\Spf \\mathcal O_K)_{\\Prism}$ via the surjection $\\mathfrak S \\rightarrow \\mO_K$ sending $u \\mapsto \\varpi$. In fact, by the argument in \\cite[Example 2.6(1)]{Bhatt-Scholze-crystal} it covers the final object of the topos $\\textup{Shv}((\\Spf \\mathcal O_K)_{\\Prism}, \\mathcal O_{\\Prism})$. Taking the Cech nerve of $(\\mathfrak S, E)$ over the final object in this topos gives rise to a cosimplicial object \n    \\begin{equation} \\label{eq:simplicial_BK}\n     \\mathfrak S \\mathrel{\\substack{\\textstyle\\longrightarrow\\\\[-0.6ex] \\textstyle\\longrightarrow}}  \\mathfrak S^{(1)}  \\mathrel{\\substack{\\textstyle\\longrightarrow\\\\[-0.6ex] \\textstyle\\longrightarrow \\\\[-0.6ex] \\textstyle\\longrightarrow}} \\mathfrak S^{(2)} \n\\end{equation}\n     in $(\\Spf \\mO_K)_{\\Prism}$. One can explicitly describe the Prisms $(\\mathfrak S^{(i)}, E)$ in terms of the prismatic envelop construction. For example, we have $\\mathfrak S^{(1)}= W [\\![u, v]\\!] \\left\\{\\frac{u - v}{E } \\right\\}^{\\wedge}_{(p, E)}$, where $\\{\\cdot\\}$ denotes the prismatic envelop.  \n    \\item Let $R =  (\\mathcal O_K %\\langle t \\rangle\n    [t])^{\\wedge}_{p}$ be the $p$-adic completion of $\\mathcal O_K [t]$ and let $R_0 = (W [t_0])^{\\wedge}_p$. Let $\\fX = \\Spf R$ be the $p$-adic formal $\\A^1$ over $\\Spf \\mathcal O_K$. \n    Let $\\mathfrak S_R = R_0 [\\![u]\\!]$, equipped with a $\\delta$-structure given by $\\varphi (u) = u^p$ and $\\varphi (t_0) = t_0^p$. As in the previous example, we have a surjection $\\mathfrak S_R \\rightarrow  R$ sending $u \\mapsto \\varpi$ and $t_0 \\mapsto t$, which makes  $(\\mathfrak S_R, E)$ into an object in $\\mathfrak X_{\\Prism}$. \n    \\end{enumerate}\n\\end{example}\n\n\\begin{lemma}\n    In the second example above, the prism $(\\mathfrak S_R, E)$ covers the final object in the topos of $(\\fX_{\\Prism}, \\mathcal O_{\\Prism})$.  \n\n    \n\\end{lemma}\n\n\\begin{proof}\n Let $(A, I)$ be a prism in the absolute prismatic site $\\fX_{\\Prism}$, equipped with a map $\\iota: R \\rightarrow A/I$. Note that $A$ is canonically a $W$-algebra. Let us pick an element $\\widetilde \\varpi$ (resp. $\\widetilde t$) in $A$ which lifts the image of $\\varpi$ (resp. of $t$) in $A/I$ under $\\iota$. Let us consider the map $A \\rightarrow (A  \\otimes_W \\mathfrak S_R)^{\\wedge}_{(p, I)}$ of $\\delta$-rings and form the prismatic envelope (see  \\cite[Proposition 3.13]{prism}) \n \\[\n  B := (A \\otimes_W \\mathfrak S_R) \\{\\frac{u- \\widetilde \\varpi, t_0 - \\widetilde t}{I}\\}^{\\wedge}_{(p, I)},\n \\]\n so we have a map $(A, I) \\rightarrow (B, IB)$ of prisms in $\\mathfrak X_{\\Prism}$. By \\cite[Proposition 3.13]{prism}, the map $A \\rightarrow B$ is $(p, I)$-completely flat, and in fact $(p, I)$-completely faithfully flat, so $(A, I) \\rightarrow (B, IB)$ forms a cover in $\\mathfrak X_{\\Prism}$.  Finally, note that by construction we have $E(u) = E (\\widetilde \\varpi) = 0 \\mod IB$, so we have $E(u) \\in IB$ and thus we have a map of prisms  $(\\mathfrak S_R, E(u)) \\rightarrow (B, IB)$ by \\cite[Lemma 2.24]{prism}. This finishes the proof of the lemma. \n\\end{proof}\n\n\\begin{definition} Let $\\fX/ \\mathcal{O}_K$ be a smooth $p$-adic formal scheme.    A \\textit{prismatic crystal (of vector bundles)} over $\\fX$ is an $\\mathcal O_{\\Prism}$-module $\\mathcal E$, such that there exists bounded prisms $(A_i, I_i)$ in $\\fX_{\\Prism}$, with $\\{U_i = \\Spf (A_i/I_i)\\} $ covering the final object of the topos of $(\\fX_{\\Prism}, \\mathcal O_{\\Prism})$, and finite projective $A_i$-modules $E_i$, such that $\\mathcal E|_{U_i} \\cong E_i \\otimes_{A_i} \\mathcal O_{\\Prism, U_i}$. A \\textit{prismatic $F$-crystal} over $\\mathfrak X$ is pair $(\\mathcal{E}, \\varphi_{\\mathcal{E}})$, where $\\mathcal E$ is a prismatic crystal and $\\varphi_{\\mathcal{E}}$ is an isomorphism \\[ \n\\varphi_{\\mathcal{E}} : \\varphi_{\\Prism}^* \\mathcal E [1/\\mathcal I_{\\Prism}] \\isom \\mathcal E [1/\\mathcal I_{\\Prism}]\n\\]    \nof $\\mO_{\\Prism}$-modules. We write $\\Vect (\\fX_{\\Prism}, \\mO_{\\Prism})$ (resp. $\\Vect^{\\varphi}(\\fX_{\\Prism}, \\mO_{\\Prism})$) for the category of prismatic crystals (resp. prismatic $F$-crystals) over $\\fX$. \n\\end{definition}\n\nFollowing notations from \\cite{Bhatt-Scholze-crystal}, for a given bounded prism $(A, I)$, we write $\\Vect (A)$ for the category of finite projective $A$-modules. We write $\\Vect^{\\varphi} (A, I)$ for the category of pairs $(E, \\varphi_E)$ that consists of a finite projective $A$-module $E$ together with an $A$-linear isomorphism $\\varphi_E: \\varphi_A^* E [1/I] \\isom E [1/I]$, with morphisms being morphisms between the finite projective $A$-modules that are compatible with  Frobenius. By $(p, I)$-completely faithfully flat descent for vector bundles (see \\cite[Proposition 2.7]{Bhatt-Scholze-crystal}), we have natural equivalences  \n\\begin{align*}\n     \\Vect (\\fX_{\\Prism}, \\mO_{\\Prism}) & \\isom  \\lim_{(A, I) \\in \\fX_{\\Prism}} \\Vect (A) \\\\ \n     \\Vect^{\\varphi}(\\fX_{\\Prism}, \\mO_{\\Prism})  & \\isom  \\lim_{(A, I) \\in \\fX_{\\Prism}} \\Vect^\\varphi(A, I)\n\\end{align*}\nIn particular, to specify a prismatic $F$-crystal over $\\fX$ is equivalent to specifying a prismatic $F$-crystal over  each bounded prism $(A, I) \\in \\fX_{\\Prism}$ in a compatible fashion. If $(A_0, I_0) \\in \\fX_{\\Prism}$ is a bounded prism that covers the final object of $\\textup{Shv} (\\fX_{\\Prism}, \\mO_{\\Prism})$, this is also equivalent to the data of a prismatic $F$-crystal over $(A_0, I_0)$ which satisfies certain the descent data coming from the Cech nerve of this cover. We will also need the following variant. \n\n\\begin{definition} \n\\begin{enumerate**}\n    \\item Let $(A, I)$ be a bounded prism, we define the category of \\textit{analytic prismatic $F$-crystals} over $(A, I)$, denoted by $\\Vect^{\\textup{an},\\varphi} (A, I)$, to be the category of pairs $(E, \\varphi_E)$ where $E$ is a vector bundle over $\\spec (A) \\backslash V(p, I)$, and $\\varphi_E$ is an  isomorphism $\\varphi_A^* E[1/I] \\isom E[1/I]$. Morphisms in $\\Vect^{\\textup{an},\\varphi} (A, I)$ are morphisms between vector bundles that are compatible with Frobenius.\n\\footnote{Note that, for a prism $(A, I)$, the Frobenius $\\varphi_A$ preserves the zero locus $V(p, I) \\subset \\spec A$ as well as its complement. Thus the definition above makes sense.} \n    \\item  Let $\\fX/ \\mathcal{O}_K$ be a smooth $p$-adic formal scheme. We define the category $\\Vect^{\\textup{an}, \\varphi} (\\fX_{\\Prism})$ of \\textit{analytic prismatic $F$-crystals} by the derived limit\n    \\[ \n    \\Vect^{\\textup{an}, \\varphi} (\\fX_{\\Prism}) := \\lim_{(A, I) \\in \\fX_{\\Prism}} \\Vect^{\\textup{an}, \\varphi}(A, I). \n    \\]\n\\end{enumerate**}\n\\end{definition}\n \n    We have a natural forgetful functor \n    $ \\Vect^{\\varphi} (\\fX_{\\Prism}) \\longrightarrow \n    \\Vect^{\\textup{an}, \\varphi} (\\fX_{\\Prism}) $  \n    from prismatic $F$-crystals to analytic prismatic $F$-crystals. This functor is induced from the map $ \\Vect^{\\varphi}(A, I) \\rightarrow  \\Vect^{\\textup{an}, \\varphi}(A, I)$\n    that sends a vector bundle over $\\spec A$ to its restriction over the complement of $V(p, I)$ for each $(A, I) \\in \\fX_{\\Prism}$ and is fully faithful. Moreover, it is compatible with crystalline realizations, in the sense that we have a commutative diagram\n    \\begin{equation} \\label{eq:prismatic_F_crystals_restriction_and_realization}\n     \\begin{tikzcd}\n    \\Vect^{\\varphi} (\\fX_{\\Prism})     \\arrow[r] \\arrow[d] &   \\Vect^{\\textup{an}, \\varphi} (\\fX_{\\Prism}) \\arrow[d]\\\\\n    \\Vect^{\\varphi}(\\fX_{s, \\textup{crys}}) \n    \\arrow[r] & \\textup{Isoc}^{\\varphi}(\\fX_{s, \\textup{crys}})\n     \\end{tikzcd}\n    \\end{equation}\n    where the vertical arrows are induced by specializing to the special fiber $\\fX_{s}$ of $\\fX$ and identifying the absolute prismatic site $\\fX_{s, \\Prism}$ of $\\fX_s$ with the $p$-completed absolute crystalline site $\\fX_{s, \\textup{crys}}$ of $\\fX_s$ (see \\cite[Construction 4.12]{Bhatt-Scholze-crystal}).    Let us consider a special case of this restriction functor in the setting of Example \\ref{Example:prisms}.  \n\\begin{lemma} \\label{lemma:an_crystal_to_alg_crystal}  Let $\\fX = \\Spf R$, where $R = (\\mathcal O_K %\\langle t \\rangle\n    [t])^{\\wedge}_{p}$. Let $U = \\spec ( \\mathfrak S_R)  \\backslash V(p, E(u)) $ be the open subset of $\\spec (\\mathfrak S_R)$ and denote by $ j: U \\rightarrow \\spec (\\mathfrak S_R) $ the open immersion. The essential image of the fully faithful functor\n    \\[ \n    \\Vect^{\\varphi} (\\fX_{\\Prism}) \\longrightarrow \n    \\Vect^{\\textup{an}, \\varphi} (\\fX_{\\Prism}) \n    \\]\nconsists of pairs $(\\mathcal E, \\varphi_{\\mathcal E})$ satisfying the following condition: if we write $(E_U, \\varphi_{U})$ for the vector bundle over $U$ obtained by evaluating $(\\mathcal E, \\varphi_{\\mathcal E})$ on the prism $(\\mathfrak S_R, E(u)) \\in \\fX_{\\Prism}$, then $j_* E_U$ is a vector bundle over $\\spec \\mathfrak S_R$. \n\\end{lemma}\n\n\\begin{proof}\n    This is \\cite[Proposition 1.26]{IKY}. \n\\end{proof}\n\n\n\\begin{definition} \\label{def:crys_local_sys} Let $\\fX/\\mO_K$ be a smooth $p$-adic formal scheme. Let $\\fX_{\\eta}/K$ be its adic generic fiber and let $\\fX_s/k$ denote the special fiber. Let $\\L$ be an \\'etale $\\Z_p$-local system on $\\fX_{\\eta}$. We say that $\\L$ is \\textit{crystalline} if there exists an $F$-isocrystal $(\\mathbb{E}, \\varphi)$ over $\\fX_s$, together with a Frobenius equivariant isomorphism of $\\mathbb{B}_{\\mathrm{crys}}$-vector bundles\n    \\[ \n     \\mathbb{B}_{\\mathrm{crys}} (\\mathbb{E}) \\isom \\mathbb{B}_{\\mathrm{crys}} \\otimes_{\\Z_p} \\L.\n    \\] \n    Here $\\mathbb{B}_{\\mathrm{crys}}(\\mathbb{E})$ is the sheaf of $\\mathbb{B}_{\\mathrm{crys}}$-modules on the pro-\\'etale site $\\fX_{\\eta,\\textup{pro\\'et}}$ associated to $(\\mathbb{E}, \\varphi)$. We denote the category of crystalline $\\Z_p$-local systems on $\\fX_{\\eta}$ by $\\textup{Loc}^{\\textup{crys}}_{\\Z_p}(\\fX_{\\eta})$. \n    \\footnote{Note that, \\textit{a priori}, the notion of crystallinity of local systems depends on the integral model $\\fX$ over $\\mathcal{O}_K$. In fact, this notion only only depends on the generic fiber $\\fX_{\\eta}$ (and independent of the chosen integral model).}\n\\end{definition}\n \n\nWe shall need the following result in the article, due to Bhatt--Scholze \\cite{Bhatt-Scholze-crystal} in the case of $\\Spf \\mO_K$ and to Du--Liu--Moon--Shimizu \\cite{DLMS1}/Guo--Reinecke \\cite{GuoReinecke} in general. \n\n\\begin{theorem}[{\\cite{Bhatt-Scholze-crystal, DLMS1, GuoReinecke}}]\\label{thm:prismatic_F_crystals_and_local_systems}\nLet $\\fX/\\mO_K$ be a smooth $p$-adic formal scheme. There is a natural equivalence of categories \n\\[ \n    \\Vect^{\\textup{an}, \\varphi} (\\fX_{\\Prism}) \\isom \\textup{Loc}^{\\textup{crys}}_{\\Z_p}(\\fX_{\\eta}). \n\\] \nIn particular, this equivalence is functorial in $\\fX$. \n\\end{theorem}\n\n\n\\begin{remark}\n    In the setting above, if $\\L$ is a crystalline $\\Z_p$-local system on $\\fX_{\\eta}$, then one can recover the $F$-isocrystal over the special fiber $\\fX_{s}$ from this equivalence via the crystalline realization (see Diagram (\\ref{eq:prismatic_F_crystals_restriction_and_realization})).  \n\\end{remark}\n \n\n \n\\begin{example} \\label{Example:prisms_revisit} Let us revisit Example \\ref{Example:prisms} once again.  \n     \\begin{enumerate**}\n         \\item Let $(\\mathfrak S, E)$ be the Breuil--Kisin prism, and let $U_0 = \\spec (\\mathfrak S) \\backslash V(p, E)$ denote the open subscheme obtained as the complement of a closed point in  $\\spec \\mathfrak S$.   %which covers the final object of the topos $\\textup{Shv}((\\Spf \\mathcal O_K)_{\\Prism}, \\mathcal O_{\\Prism})$, \n         Theorem \\ref{thm:prismatic_F_crystals_and_local_systems} (due to Bhatt--Scholze in this context) says that a $\\Z_p$-lattice $\\Lambda$ in a crystalline $\\textup{Gal}_K$-representation is equivalent to the data of a vector bundle $\\mE_0$ over $U_0 = \\spec (\\mathfrak S) \\backslash V(p, E)$, equipped with a Frobenius isomorphism after inverting $E$, as well as the descent data coming from the cosimplicial complex (\\ref{eq:simplicial_BK}). Since $\\mathfrak S$ is a regular local scheme of dimension 2, $\\mE_0$ uniquely extends to a vector bundle over $\\spec \\mathfrak S$, which still carries the Frobenius isomorphism after inverting $E$, and again satisfies descent. In other words, for $\\Spf \\mO_K$, the fully faithful embedding $\n    \\Vect^{ \\varphi} ((\\Spf \\mO_K)_{\\Prism}) \\rightarrow  \n    \\Vect^{\\textup{an}, \\varphi} ((\\Spf \\mO_K)_{\\Prism}) $ is an equivalence. Moreover, via Theorem \\ref{thm:prismatic_F_crystals_and_local_systems} and  this equivalence, a $\\Z_p$-lattice $\\Lambda$ in a crystalline representation is equivalent to a \\textit{Breuil--Kisin module} $(\\mathfrak M, \\varphi_{\\mathfrak M})$ that satisfies descent along the cosimplicial complex (\\ref{eq:simplicial_BK}), that is, equipped with a descent isomorphism after pulling back to $\\mathfrak S^{(1)}$ which satisfies a cocycle condition over $\\mathfrak S^{(2)}$.%\\footnote{By works of Kisin \\cite{Kisin_crystal} (see also \\cite[\\S 7]{Bhatt-Scholze-crystals}) the essential image is cut out by conditions on poles of certain logarithmic connection. } %Kisin does this after inverting p. %\n   \\item Let $R =  (\\mO_K [t]^{\\wedge}_{p})$ be as in Example \\ref{Example:prisms} (2) and let $\\fX = \\Spf R$, so $\\fX_{\\eta} = \\sD = \\textup{Spa} (R[1/p], R)$ is the closed unit disc over $K$. In this case, Theorem \\ref{thm:prismatic_F_crystals_and_local_systems} tells us that crystalline $\\Z_p$-local system on $\\sD$ is equivalent to the category of analytic prismatic $F$-crystals over $\\fX$. In particular, it gives rise to a vector bundle $E_U$ over $U = \\spec (\\mathfrak S_R) \\backslash V(p, E(u))$ equipped with a Frobenius $\\varphi_E$ (by evaluating the analytic prismatic $F$-crystal on the prism $(\\mathfrak S_R, E(u))$). \n%   \\[ \n%   \\textup{ev}:    \\Vect^{\\textup{an}, \\varphi} (\\fX_{\\Prism})  \\rightarrow  \\Vect^{\\textup{an}, \\varphi} (\\mathfrak S_R, E(u)) \n%   \\] evaluating on the prism $(\\mathfrak S_R, E)$, we obtain  \n   \\end{enumerate**}\n\\end{example}\n\n\n\n \n%%\n%%\n%%\n%%\n \n\n\\section{From $F$-isocrystals to $F$-crystals}\\label{Sec:pointwiseconstancy} \n\n\nLet $\\mathbb L$ be a crystalline $\\Z_p$-local system on the closed unit disc $\\sD$, and let $\\mathbb E$ be the $F$-isocrystal over the special fiber of $\\sD$ (which is a copy of $\\A^1_{k}$) attached to $\\mathbb L$. Let us also recall that, if $V$ is a crystalline $\\Q_p$-representation of the Galois group $\\textup{Gal}_K$ with nonnegative Hodge--Tate weights, and $\\Lambda \\subset V$ is a $\\textup{Gal}_K$-stable $\\Z_p$-lattice, then one can attach to $\\Lambda$ a Frobenius module \n\\[\\mathbb D_{\\textup{crys}} (\\Lambda) = (M, \\varphi_M),\\] which consists of a finite free $W(k)$-module $M$ together with a Frobenius map $\\varphi_M: M \\rightarrow M$ that becomes an isomorphism upon inverting $p$. This can be achieved by considering the Breuil--Kisin module $(\\mathfrak M, \\varphi_{\\mathfrak M})$ and base changing along the map $\\mathfrak S = W(k) [\\![u]\\!] \\rightarrow W(k)$ sending $u \\mapsto 0$. We may regard $\\mathbb D_{\\textup{crys}} (\\Lambda)$ as %The data $(M, \\varphi_M)$ is equivalent to the data of \nan $F$-crystal over $\\spec k$ (see Example \\ref{Example:prisms_revisit} and also see Diagram (\\ref{eq:prismatic_F_crystals_restriction_and_realization})).  The goal of this section is to show the following. \n\n\\begin{theorem} \\label{prop:existence_of_crystal}\n   Assume the above setup.  Up to replacing $\\sD$ by a smaller \n   closed disc in $\\sD$ if necessary, there exists an $F$-crystal $\\mathbb D$ over $\\A^1$ with $\\mathbb D [1/p] \\cong \\mathbb E$, that is compatible with the crystalline $\\Z_p$-local system  $\\mathbb L$ in the following sense: for every finite extension $L/K$ and every classical $L$-point $x \\in \\sD$ which specializes to a closed point $\\overline{x} \\in \\A^1$,  there is an isomorphism $\\mathbb D|_{\\overline{x}} \\cong \\mathbb D_{\\textup{crys}} (\\mathbb L|_{x})$  of $F$-crystals over $\\overline{x}$. Consequently, up to replacing $\\sD$ by a smaller disc, the isomorphism class of the $F$-crystal $\\mathbb{D}_{\\textup{cris}}(\\bL_x)$ is independent of the classical point $x\\in \\sD$.\n\\end{theorem}   \n\n%In order to prove this, we will start with the analytic prismatic $F$-crystal $\\mathcal E^{\\textup{an}}$ attached to $\\mathbb L$, which can be viewed as a \n\n\n \n\n\\subsection{Locally free extensions}\n  Let $\\mathcal T$ be an admissible $p$-adic formal scheme over $\\Spf W$, and consider the sheaf of rings $\\cO_{\\mathcal T}[\\![u]\\!]$.\\footnote{In the context of \\Cref{Example:prisms}(2), the reader may take $\\mathcal T = \\Spf R_0$ as a working example in this subsection.} We say $\\mathcal T$ is regular if every local ring is regular.  In this section we prove the following:\n\n\n\\begin{proposition}\\label{prop:blow-up to resolve}\n    Let  $\\mathcal T$ be a regular 2-dimensional $p$-adic formal scheme over $\\Spf W$ and $E$ a finitely generated $\\cO_{\\mathcal T}[\\![u]\\!]$-module.  Then there is a sequence \\[\n    \\mathcal T'=\\mathcal T_n\\to\\cdots \\to\\mathcal T_1=\\mathcal T\\] of formal admissible blow-ups at closed points, such that $(f[\\![u]\\!]^*E)^{\\vee\\vee}$ is locally free as an $\\mathcal O_{\\mathcal T} [\\![u]\\!]$-module, where $f: \\mathcal T' \\rightarrow \\mathcal T$ denotes the composition of sequence of maps above.  \n\\end{proposition}\n\n\nWe begin with the following observation.\n\n\n\\begin{lemma}\\label{lem:vanishing}Let $\\cO$ be a 3-dimensional regular local ring and $E$ a finitely generated reflexive $\\cO$-module.  Then $\\Ext^i_\\cO(E,\\cO)=0$ for $i>1$.\n\\end{lemma}\n\\begin{proof}\n Every term in the double dual spectral sequence \\[R\\Hom_\\cO(R\\Hom_\\cO(E,\\cO),\\cO)=E\\]\n vanishes except $E^{\\vee\\vee}$, $\\Ext^1_\\cO(E^\\vee,\\cO)$, and $\\Ext^3_\\cO(\\Ext^1_\\cO(E,\\cO),\\cO)$.  In particular, this implies that $\\Ext^3_\\cO(\\Ext^i_\\cO(E,\\cO),\\cO)=0$ for $i>1$, so $\\Ext^i_\\cO(E,\\cO)=0$ by local duality.\n\\end{proof}\nThe main step of \\Cref{prop:blow-up to resolve} is the following:\n\\begin{lemma}\\label{lem:strictly decreasing}Let $\\cO$ be a 3-dimensional regular local ring and $E$ a finitely generated reflexive $\\cO$-module which is not free.  Let $f:X\\to\\Spec\\cO$ be the blow-up along any regular curve.  Then we have \n\\[\\ell(\\sExt^1_{\\cO_X}((f^*E)^\\vee,\\cO_X))<\\ell(\\Ext^1_\\cO(E^\\vee,\\cO)),\\]\nwhere $\\ell $ denotes the length of ($\\mathcal O$-)modules. \n\\end{lemma}\n\\begin{proof}\n\\noindent\\emph{Step 1.}  $E$ has a presentation of the form\n\\begin{equation}\\label{eq:present}\\begin{tikzcd}0\\ar[r]&\\cO^m\\ar[r,\"A\"]&\\cO^n\\ar[r]& E\\ar[r]& 0\\end{tikzcd}.\\notag\\end{equation}\n\\begin{proof}\n    Consider any presentation\n\\begin{equation}\\label{eq:present}\\begin{tikzcd}\\cO^m\\ar[r,\"A\"]&\\cO^n\\ar[r]& E\\ar[r]& 0\\end{tikzcd}.\\notag\\end{equation}\nWe claim that $N=\\img(A)$ is free.  Indeed, applying $RHom_\\cO(-,\\cO)$ to the sequence\n\\[\\begin{tikzcd}0\\ar[r]&N\\ar[r]&\\cO^n\\ar[r]& E\\ar[r]& 0\\end{tikzcd}\\]\nand using \\Cref{lem:vanishing}, we see that $\\Ext^i_\\cO(N,\\cO)=0$ for $i>0$.\n\\end{proof}\n\n\n\n\\noindent\\emph{Step 2.}  Let $M$ be any nonzero finitely-generated $\\cO$-module supported on (some thickening of) the closed point $x$ of $\\Spec\\cO$.  Then $L^if^*M=0$ for $i<-1$ and $H^0(\\sExt_{\\cO_X}^2(L^{-1}f^*M,\\cO_X))\\neq 0$.\n\\begin{proof}First observe that the vanishing claim is true for $M=k(x)$ using the Koszul resolution.  In general we may take a short exact sequence \n\\[\\begin{tikzcd}\n    0\\ar[r]&M'\\ar[r] &M\\ar[r]&k(x)\\ar[r]&0.\n\\end{tikzcd}\\]\nand the vanishing follows from the above observation by induction on $\\ell(M)$.\n\nFor the second claim, again observe that the claim is true for $M=k(x)$ since $L^{-1}f^*k(x)=\\cO_C(-1)$ where $C=f^{-1}(x)\\cong \\P^1_{k(x)}$ and $\\sExt^2_{\\cO_X}(\\cO_C(-1),\\cO_X)=\\cO_C$.  In general, using the same sequence we have an exact sequence\n\\[\n\\begin{tikzcd}\n0\\ar[r]&L^{-1}f^*M'\\ar[r]&L^{-1}f^*M \\ar[r]& \\cO_C(-1)\n\\end{tikzcd}\n\\]\nand the image of the rightmost map is therefore either 0 or $\\cO_C(-a)$ for some $a\\geq 1$.  Thus by induction we may assume we are in the latter case.  But then we have an inclusion\n\\[\\begin{tikzcd}\n    0\\ar[r]&\\cO_C(a-1)\\cong\\sExt^2_{\\cO_X}(\\cO_C(-a),\\cO_X)\\ar[r]& \\sExt^2_{\\cO_X}(L^{-1}f^*M,\\cO_X)\n\\end{tikzcd}\\]\nwhence the claim.\n\\end{proof}\nTaking the dual of the presentation from Step 1 we have\n\\[\\begin{tikzcd}\n    0\\ar[r]&E^\\vee\\ar[r]&\\cO^n\\ar[r,\"A^*\"]&\\cO^m\\ar[r]&\\Ext^1_\\cO(E,\\cO)\\ar[r]&0.\n\\end{tikzcd}\\]\nLet $F=\\img(A^*)$ and $Q=\\Ext^1_\\cO(E,\\cO)$.\n\\vskip1em\n\\noindent\\emph{Step 3.}  We have $L^if^*F=0$ and $L^if^*(E^\\vee)=0$ for $i<0$.\n\\begin{proof}Pulling back the sequence\n\\[\\begin{tikzcd}\n    0\\ar[r]&F\\ar[r]&\\cO^m\\ar[r]& Q\\ar[r]&0\n\\end{tikzcd}\\]\nand using the vanishing in Step 2 implies the first claim.  Pulling back \n\\[\\begin{tikzcd}\n    0\\ar[r]&E^\\vee\\ar[r]&\\cO^n\\ar[r]& F\\ar[r]&0\n\\end{tikzcd}\\]\nand using the first claim implies the second.\n\\end{proof}\n\\noindent\\emph{Step 4.}    There is a natural short exact sequence\n\\[\\begin{tikzcd}\n    0\\ar[r]&f^*(E^\\vee)\\ar[r] &(f^*E)^\\vee\\ar[r]&L^{-1}f^*Q\\ar[r]&0.\n\\end{tikzcd}\\]\n\\begin{proof}Since $\\cO_X$ is torsion-free, pulling back the presentation from Step 1 we have an exact sequence\n\\[\\begin{tikzcd}\n0\\ar[r]&\\cO_X^m\\ar[r,\"f^*A\"]&\\cO_X^n\\ar[r]&f^*E\\ar[r]&0\n\\end{tikzcd}\\]\nand therefore an exact seqeunce\n\\[\\begin{tikzcd}\n0\\ar[r]&(f^*E)^\\vee\\ar[r]&\\cO_X^n\\ar[r,\"f^*A^*\"]&\\cO_X^m.\n\\end{tikzcd}\\]\nNow applying the previous step to the diagram with exact diagonals\n\\[\\begin{tikzcd}[/tikz/cells={/tikz/nodes={shape=asymmetrical\n  rectangle,text width=1.5cm,text height=2ex,text depth=0.3ex,align=center}},row sep=tiny, column sep=tiny]\n%[row sep=tiny, column sep=tiny]\n{}&0\\ar[dr]&{}&{}&{}&{}&{}\\\\\n{}&{}&L^{-1}f^*Q\\ar[dr]&{}&0&{}&{}\\\\\n    {}&{}&{}&f^*F\\ar[ur]\\ar[dr]&{}&{}&{}\\\\\n    {}&{}&\\cO_X^n\\ar[ur]\\ar[rr,\"f^*A^*\",swap]&{}&\\cO_X^m\\ar[rd]&{}&{}\\\\\n   {}& f^*(E^\\vee)\\ar[ur]&{}&{}&{}&f^*Q\\ar[rd]&{}\\\\\n    L^{-1}f^*F\\ar[ur]&{}&{}&{}&{}&{}&0\n\\end{tikzcd}\\]\nyields the claim.\n\\end{proof}\n\n\n\\noindent\\emph{Step 5.}  There is a natural short exact sequence\n\\[\\begin{tikzcd}\n    0\\ar[r]&H^1(f^*(E^\\vee)^\\vee)\\ar[r] &\\Ext^1_{\\cO}(E^\\vee,\\cO)\\ar[r]&H^0(\\sExt_{\\cO_X}^1(f^*(E^\\vee),\\cO_X))\\ar[r]&0.\n\\end{tikzcd}\\]\nIn particular, $\\ell(\\sExt_{\\cO_X}^1(f^*(E^\\vee),\\cO_X))\\leq \\ell(\\Ext^1_\\cO(E^\\vee,\\cO))$.\n\\begin{proof}Use\n\\[Rf_*(R\\sHom_{\\cO_X}(Lf^*(E^\\vee),\\cO_X))=R\\Hom_\\cO(E^\\vee,Rf_*\\cO_X)\\]\ntogether with $Rf_*\\cO_X=\\cO$ and the vanishing of $L^{i}f^*(E^\\vee)$ for $i<0$ from Step 3.\n\\end{proof}\n\n\\noindent\\emph{Step 6.}  \\[\\ell(\\sExt^1_{\\cO_X}((f^*E)^\\vee,\\cO_X))\\leq \\ell(\\Ext^1_\\cO(E^\\vee,\\cO))-\\ell(H^0(\\sExt^2_{\\cO_X}(L^{-1}f^*Q,\\cO_X))).\\]\n\\begin{proof}\n    Applying $R\\Hom_{\\cO_X}(-,\\cO_X)$ to the sequence from Step 4 and using the vanishing from \\Cref{lem:vanishing} we have an exact sequence\n\\[\\begin{tikzcd}\n    0\\ar[r]&\\sExt^1_{\\cO_X}((f^*E)^\\vee,\\cO_X)\\ar[r]& \\sExt^1_{\\cO_X}(f^*(E^\\vee),\\cO_X)\\ar[r]& \\sExt^2_{\\cO_X}(L^{-1}f^*Q,\\cO_X)\\ar[r]&0.\n\\end{tikzcd}\\]\nThe first term has dimension 0, so the sequence remains exact on taking global sections\n\\[\\begin{tikzcd}[sep=small]\n    0\\ar[r]&H^0(\\sExt^1_{\\cO_X}((f^*E)^\\vee,\\cO_X))\\ar[r]& H^0(\\sExt^1_{\\cO_X}(f^*(E^\\vee),\\cO_X))\\ar[r]& H^0(\\sExt^2_{\\cO_X}(L^{-1}f^*Q,\\cO_X))\\ar[r]&0.\n\\end{tikzcd}\\]\nCombining this with Step 5, we have the claim.\n\\end{proof}\n\\noindent\\emph{Step 7.}  Conclusion of proof.\n\\vskip1em\nBy the assumption on $E$ and \\Cref{lem:vanishing} we have $Q\\neq 0$.  But then by the nonvanishing in Step 2 we have $0\\neq \\ell(H^0(\\sExt^2_{\\cO_X}(L^{-1}f^*Q,\\cO_X)))$, so the claim follows from Step 6.\n\\end{proof}\n\n\\begin{proof}[Proof of \\Cref{prop:blow-up to resolve}]\n Note it is equivalent to show $(f[\\![u]\\!]^*E)^\\vee$ is locally free.  Since $E^\\vee$ is a reflexive $\\mathcal O_{\\mathcal T} [\\![u]\\!]$-module, we have \\[ \\sExt^i_{\\mathcal O_{\\mathcal T} [\\![u]\\!]}(E^\\vee,\\mathcal O_{\\mathcal T} [\\![u]\\!])=0\\] for $i>1$ by \\Cref{lem:vanishing}. Moreover,   $\\sExt^1_{\\mathcal O_{\\mathcal T} [\\![u]\\!]}(E^\\vee,\\mathcal O_{\\mathcal T} [\\![u]\\!])$ is supported at finitely many closed points, hence has finite length $\\ell$.  We proceed by induction on $\\ell$, the $\\ell=0$ case being trivial.  Let $x \\in \\mathcal T$ be any point in the support, $\\cO_{\\mathcal T,x}$ the local ring of $\\mathcal T$ at $x$ with maximal idea $\\frak m_x$, and let $\\frak n_x$ be the ideal generated by $\\frak m_x$ in $\\cO_{\\mathcal T,x}[\\![u]\\!]$.  Let \n \\[ \\pi:B\\to \\Spec\\cO_{\\mathcal T,x} \\] be the blow-up at $\\frak m_x$, and note that: \n \\begin{itemize} \n     \\item  \n the base-change $\\pi[\\![u]\\!]:B[\\![u]\\!]\\to \\Spec (\\cO_{\\mathcal T,x} [\\![u]\\!])$ is the blow-up at $\\frak n_x$, where $B[\\![u]\\!]$ denotes the scheme theoretic base change $B[\\![u]\\!] := B \\times_{\\Spec (\\cO_{\\mathcal T,x}} \\Spec (\\cO_{\\mathcal T,x} [\\![u]\\!])$;\n \\item  the $p$-adic completions of the local rings of $B$ are identified with the local rings of the formal admissible blow-up \n \\[ g:\\mathcal T'\\to \\mathcal T \\] of $\\mathcal T$ at $x$.  \n \\end{itemize}   In particular, for a closed point $x'$ of $\\mathcal T'$ (which we also view as a closed point in $B [\\![u]\\!]$), the $p$-adic complete local ring \n \\[ (\\mathcal O_{\\mathcal T'} [\\![u]\\!])_{x'} = \\mathcal O_{\\mathcal T', x'} [\\![u]\\!] \\]   is flat over $\\cO_{B[\\![u]\\!],x'}$. Here  $(\\mathcal O_{\\mathcal T'} [\\![u]\\!])_{x'}$ denotes the stalk of the sheaf $\\mathcal O_{\\mathcal T'} [\\![u]\\!]$ of the $p$-adic formal scheme $\\mathcal T'$ at $x'$ \n\nAccording to \\Cref{lem:strictly decreasing}, the length of $\\sExt^1_{\\mathcal O_{B[\\![u]\\!], x'}}((\\pi[\\![u]\\!]^*E_x)^\\vee,\\cO_{B [\\![u]\\!], x'})$ is strictly smaller than \\[ \\ell_x := \\sExt^1_{\\mathcal O_{\\mathcal T, x} [\\![u]\\!]}(E_x^\\vee,\\mathcal O_{\\mathcal T, x} [\\![u]\\!]),\\] so the same is true of $\\sExt^1_{ (\\mathcal O_{\\mathcal T'} [\\![u]\\!])_{x'}}((g[\\![u]\\!]^*E_x)^\\vee, (\\mathcal O_{\\mathcal T'} [\\![u]\\!])_{x'})$.  Therefore, we know that \n\\[ \\ell \\big(  \\sExt^1_{ \\mathcal O_{\\mathcal T'} [\\![u]\\!]}((g[\\![u]\\!]^*E)^\\vee,\\mathcal O_{\\mathcal T'} [\\![u]\\!]) \\big) < \\ell.\\] \nBy induction the proof is complete.\n\\end{proof}\n\n\\subsection{Existence of the Prismatic $F$-crystal} \n\nWe are now ready to prove Theorem \\ref{prop:existence_of_crystal}. \n\n\\begin{proof}[Proof of Theorem \\ref{prop:existence_of_crystal}]\nLet $\\mathfrak X = \\Spf R = \\Spf (\\mathcal O_K [t])^{\\wedge}_{p}$ be an integral model of $\\sD$ as in the setting of Example \\ref{Example:prisms_revisit} (2). In particular, the crystalline local system $\\mathbb L$ gives rise to a vector bundle $E_U$ over $U = \\spec (\\mathfrak S_R) \\backslash V(p, E(u))$, where we recall that $\\mathfrak S_R = R_0 [\\![u]\\!]$ and $R_0 = (W [t_0])^\\wedge_p$. Let $\\fX_0 = \\Spf R_0$ (which is another copy of the $p$-adic formal $\\A^1$). Let $E = j_* E_U$ where $j: U \\rightarrow \\spec \\mathfrak S_R$ is the open immersion, which is a reflexive module over $\\mathcal O_{\\mathfrak X_0} [\\![u]\\!]$. By Proposition \\ref{prop:blow-up to resolve}, we know that there exists successive admissible blowups of $\\mathfrak X_0$ at closed points such that the pullback  $\\pi[\\![u]\\!]^*E$ is a locally free $\\mathcal O_{\\mathfrak X_0'} [\\![u]\\!]$-module, where $\\pi: \\mathfrak X_0' \\rightarrow \\mathfrak X_0$ is the composition of the required  blowups. From the proof of Proposition \\ref{prop:blow-up to resolve}, we know that by shrinking the radius of the disc in the generic fiber at each step of the blowup if necessary, we may without loss of generality assume that at each step we only need to blowup at the origin. In other words, the required blowups $\\pi$ can be achieved by the map $\\pi_n: R_0 = (W [t_0])^\\wedge_p \\rightarrow R_n = (W [t_n])^\\wedge_p$ sending $t_0 \\mapsto p^n t_n$ for some large enough integer $n$. This means that, after replacing the disc $\\sD$ by its closed subdisc $\\sD_n = \\{|z| \\le 1/p^n\\}$, the local system $\\mathbb L|_{\\sD_n}$ gives rise to a pair $(E_{n, U}, \\varphi_{n, U})$ where $E_{n, U}$ is a vector bundle over $U_n = \\Spec R_n [\\![u]\\!] \\backslash V(p, E(u))$ that extends to a vector bundle over $\\Spec R_n [\\![u]\\!]$. By Lemma \\ref{lemma:an_crystal_to_alg_crystal}, $\\L|_{\\sD_n}$ in fact gives rise to a (unique up to isomorphism) prismatic $F$-crystal $(\\mathcal E_n, \\varphi_n)$ over $\\Spf (\\mathcal O_K [t'])^\\wedge_p$ where $t' = p^n t$. This prismatic $F$-crystal is compatible with the $F$-crystal $\\mathbb D_{\\textup{crys}} (\\mathbb L|_{x})$ under specialization to closed points $x \\in \\sD_n$ by the functoriality of the equivalence in Theorem \\ref{thm:prismatic_F_crystals_and_local_systems}. This finishes the proof of the theorem. \n\\end{proof}\n\n\n\n%%%\n%%%\n%%%\n\\section{Constancy of the $F$-crystal} \\label{sec: constancy}\nIn this section, we will prove that the fiber-wise $F$-crystal produced in Section \\ref{Sec:pointwiseconstancy} is actually constant. Our argument is essentially Lemmas 1.10 and 1.9 of \\cite{oortleaves} in the setting of $F$-crystals.\n\n\n\\begin{lemma}[Oort, Lemma 1.10]\\label{Lemmaoort1.10}\n    Let $\\D_1$ and $\\D_2$ be two $F$-crystals over $\\Fpbar$ having the same rank and let $N$ be a fixed integer. Then there are finitely many sub-crystals of $\\D_2$ isomorphic to $\\D_1$ whose co-kernel is $p^N$ torsion.\n\\end{lemma}\n\\begin{proof}\n    Let $L = \\Hom(\\D_1,\\D_2)$. Consider the set $S \\subset L$ defined as $S = \\{f\\in L: \\Im(f) \\supset p^N \\D_2 \\}$. Let $f_1,f_2 \\in S$ be two maps such that $f_1 \\equiv f_2 \\mod p^N$ in $L/p^N$. A direct computation shows that $\\Im f_1 = \\Im f_2$. It follows that the number of sub-crystals is bounded by the image of the subset $S$ in $L/p^N$. The lemma follows from the fact that $L$ is a finite generated $\\Z_p$ module.\n\\end{proof}\n\n\\begin{definition}\n    Let $X/\\Fpbar$ be a scheme and $\\D$ an $F$-(iso)crystal.  Let $\\pt_X:X\\to \\Spec\\Fpbar$ be the map to a point, and for any point $x\\in X(\\Fpbar)$ let $i_x:\\Spec\\Fpbar\\to X$ be the corresponding morphism.\n    \\begin{enumerate}\n    \\item We say $\\D$ is \\emph{constant} if there is an (iso)crystal $\\D_0$ on $\\Spec\\Fpbar$ such that if $\\D\\cong \\pt_X^*\\D_0$.\n    \\item We say $\\D$ is \\emph{point-wise constant} if there is an (iso)crystal $\\D_0$ on $\\Spec\\Fpbar$ such that $i_x^*\\D\\cong \\D_0$ for every $x\\in X(\\Fpbar)$.\n    \\end{enumerate}\n\\end{definition}\nWe are now ready to prove \n\\begin{theorem}\\label{thm: constancy of F-crystal}\nLet $X$ be a smooth connected variety over $\\Fpbar$. Let $\\D /X$ be a point-wise constant $F$-crystal such that the $F$-isocrystal $\\D[1/p]$ is constant. Then $\\D$ itself is constant.\n\\end{theorem}\n\n\\begin{proof}\n    Let $\\D_0  $ be the $F$-crystal $i_x^*\\D$ for $x\\in X(\\Fpbar)$. The constancy of $\\D[1/p]$ gives an isogeny $g: \\D \\rightarrow \\pt_X^* \\D_0$. By Lemma \\ref{Lemmaoort1.10}, the set $X(\\Fpbar)$ admits a partition into finitely many subsets $X_1 \\hdots X_m$ such that for two points $x,x' \\in X_i$, we have $g_x(\\D_x) = g_{x'}(\\D_{x'})$. Without loss of generality, suppose that $X_1$ is Zariski dense, and let $x\\in X_1$ be any point. Consider the inclusion of crystals $g': \\pt_X^*\\D_0 \\rightarrow \\pt_X^*\\D_0$, where $g' = \\pt_X^* g_x$. We now have that $\\Im g'$ and $\\Im g$ are two subcrystals of $\\pt^*\\D_0$ which agree on a Zariski-dense set of points. We will now show that they are the same. \n    \n    We first reduce to the case that $X$ is affine.  We claim that for two crystals $\\D_1,\\D_2$ on $X$ and any dense Zariski open $U\\subset X$, any morphism $f_U:\\D_1|_U\\to \\D_2|_U$ extends uniquely to a morphism $f:\\D_1\\to \\D_2$.  By the uniqueness, such an extension patches, so we may assume $X$ is affine, and in particular lifts to a formally smooth scheme $\\fX/ W(\\Fpbar)$ equipped with a lift of Frobenius $\\phi:\\fX\\to\\fX$.  Then $\\D_1$ corresponds to a flat vector bundle $E_1$ on $\\fX$ together with a flat morphism $\\phi_{E_1}:\\phi^*E_1\\to E_1$ for which $\\phi_{E_1}[1/p]$ is an isomorphism; likewise for $\\D_2$ and $E_2$.  Then $f$ yields a morphism $\\ff_\\fU:E_1|_{\\fU}\\to E_2|_{\\fU}$.  In characteristic 0, it is easy to see that $\\ff_\\fU[1/p]$ extends uniquely to a moprhism $E_1|_{\\fX[1/p]}\\to E_2|_{\\fX[1/p]}$.  But then the underlying morphism of vector bundles $E_1\\to E_2$ is defined outside of a set of codimension 2, hence extends uniquely, and the extension is compatible with the connection and the Frobenius structure. \n\n    Therefore, we suppose that $X = \\Spec A$. Let $\\tilde{A}$ (cite the people Kedlaya cites!) be a $p$-adically complete smooth $W$-algebra with a lift of Frobenius such that $A = \\tilde{A} \\mod p$. Evaluating all these crystals on $\\tilde{A}$, we obtain two Frobenius-stable flat-subbundles of $\\D_0\\otimes \\tilde{A}$ which: \n    \\begin{enumerate}\n        \\item Are the same after inverting $p$.\n        \\item Agree at a dense set of $W$-points.\n    \\end{enumerate}\n    Even without using $F$-crystal structure, the formal-smoothness of $\\tilde{A}$ implies that the these two sub-bundles must already agree. The theorem follows. \n\n    \n\\end{proof}  \n\n\n\\section{Proof of the extension theorem for $\\Dstar$}\\label{sec: Dstar}\n\nIn this section, we prove our main results for $\\sD^\\times$. \n\n\\subsection{Extending crystalline local systems}\nThe following result is Theorem 1.17 of \\cite{DY}. \n\\begin{theorem}[\\cite{DY}]\\label{thm: crystalline extension}\n    Let $\\bL/\\Dstar$ be a $\\Z_p$-local system with crystalline fibers everywhere. Then, $\\bL$ extends to a crystalline local system on $\\sD$. \n\\end{theorem}\nFor the sake of completeness, we will sketch a proof in the easy case where in addition there exists a smooth formal scheme $\\fX$, a crystalline $\\mathbb Z_p$-local system $\\bL'/\\fX_\\eta$, and a map $g: \\Dstar \\rightarrow \\fX_\\eta$ such that  $\\bL = g^* \\bL'$. Let $\\mathbb{E}[1/p]$ denote the isocrystal associated to $\\bL'$ on $\\frak{X}_p$. Consider the flat bundle underlying the filtered flat bundle $\\mathcal{RH}_p(\\bL)/\\Dstar$ (resp. $\\mathcal{RH}_p(\\bL')/\\fX_\\eta$)---we will somewhat abusively use the same notation both for the filtered flat bundles and the underlying flat bundles. We have that $\\mathbb{E}[1/p](\\fX)$ is canonically isomorphic to $\\mathcal{RH}_p(\\bL')$ (see for eg \\cite[Lemma 3.7]{bst-integral-canonical}). It suffices to prove that $\\mathcal{RH}_p(\\bL)$ extends to a flat bundle on $\\sD$, by \\cite[Theorem 5.7]{p-adic-borel-Ag}. We will in fact use the fact that $\\bL$ is pulled back from $\\fX_\\eta$ to conclude that $\\mathcal{RH}_p(\\bL)|_{\\sD'}$ is actually the trivial flat bundle for every closed sub-disc\\footnote{In fact, we do not need to restrict to $\\sD'$ for this triviality if $\\fX$ satisfies the property that every map $\\mathbb{A}^1 \\rightarrow \\fX_p$ extends to a map $\\mathbb{P}^1\\rightarrow \\fX_p$. We note that $\\integralS$ does satisfy this property.} of $\\sD' \\subsetneq \\sD$. Indeed, it suffices to prove that $\\mathcal{RH}_p(\\bL)|_{\\Ann'_n}$ is the trivial flat bundle for every integer $n$, where $\\Ann'_n := \\Ann_n \\cap \\sD'$. We pick an integral model $\\frak{g'}_n: \\mathfrak{A}'_n \\rightarrow  \\mathfrak{A}_{n+1} \\rightarrow \\fX$ of the composite map $g_n':=\\Ann'_n \\subsetneq \\Ann_n \\xrightarrow{g|_{\\Ann_{n+1}}}\\fX_\\eta$. By the appendix of \\cite{p-adic-borel-Ag}, we may assume that the irreducible components of the reduced special fiber $C_{n+1}$ (resp. $C'_n$) of $\\frak{A}_{n+1}$ (resp. $\\frak{A}'_n$) consist of (two) $\\mathbb{A}^1$s and (an unspecified but finite number of) $\\mathbb{P}^1$s, with the further condition that the there is no combinatorial monodromy. By \\cite[Remark A.7]{p-adic-borel-Ag}, there is a marked point $x_i$ on each of the two $\\mathbb{A}^1$s in $C_{n+1}$ such that no point in the open annulus $\\Ann^\\circ_{n+1}$ specializes to a point in $\\mathbb{A}^1 \\setminus \\{ x_i\\}$. It follows that the image of $C'_n$ in $C_{n+1}$ is contained in a proper (possibly reducible) curve, and in particular, $\\frak{g}'_n$ extends to the compactification $\\bar{C'}_n$ of $C'_n$, whose irreducible components are now solely $\\mathbb{P}^1$s (and there is still no combinatorial monodromy). Every $F$-isocrystal on $\\bar`{C}'_n$ is trivial, and therefore $\\frak{g}^{\\prime,*}_n(\\mathbb{E}[1/p])$ is trivial. Evaluating on the thickening given by $\\frak{A}'_n$, we have that $\\frak{g}^{\\prime,*}_n(\\mathbb{E}[1/p])(\\frak{A}'_n)$ is trivial. The result now follows from the chain of isomorphisms $\\frak{g}^{\\prime,*}_n(\\mathbb{E}[1/p])(\\frak{A}'_n) \\simeq g^{\\prime,*}_n(\\mathbb{E}[1/p](\\fX)) \\simeq g^{\\prime,*}_n(\\mathcal{RH}_p(\\bL)) \\simeq \\mathcal{RH}_p(\\bL|_{\\Ann'_n})$.\n\nA very similar argument also works in the setting of geometric period images. Indeed, let $j$ be the smallest integer such that the image of $\\Ann_n$ is contained in $(Y^j)^{\\an}$. Then, there is a finite subset $\\Xi \\subset \\Ann_n$ whose complement maps to $(Y^{j})^{\\an}\\setminus (Y^{j-1})^{\\an}$. As $S^j \\rightarrow Y^j$ is an isomorphism away from $Y^{j-1}$, $\\Ann_n \\setminus \\Xi$ lifts to $(S^j)^{\\an}$. The fact that $S^j \\rightarrow Y^j$ is proper allows us to extend this to a map $\\Ann_n \\rightarrow (S^{j})^{\\an}$. Now, the identical argument outlined above works. \n\n\\subsection{The Shimura case}\n\n\nWe have the following proposition. \n\\begin{proposition}\\label{prop: constantFLconstantmap}\n    Let $g:C\\rightarrow \\integralS_p$ be a map where $C$ is a curve over $\\Fpbar$. Suppose that $g^{*}\\Vcris$ is constant on $C$. Then the map $g$ is constant. \n\\end{proposition}\n\\begin{proof}\nWe first replace $C$ by its image -- note that the $F$-crystal remains constant. By replacing $C$ by an open subset, we may assume that $C$ is a smooth curve. We pick a smooth lift $\\tilde{C}/W$. Consider $g^* \\Vdr$, the filtered flat bundle on $S$ pulled back to $C$. The underlying flat bundle is obtained by taking the mod $p$ reduction of the flat bundle $(g^* \\Vcris)(\\tilde{C})$. The filtration is simply the kernel of (powers of) Frobenius mod $p$. Therefore, we have that $g^*\\Vdr$ is constant as a filtered flat bundle. This implies that the Kodaira-Spencer map is trivial on $C$, which contradicts the versality of the Kodaira-Spencer map. The proposition follows. \n\\end{proof}\n\nWe are now ready to prove the one-dimensional disk case of \\Cref{thm:introextension} for a Shimura variety.\n\n\\begin{theorem}\n    \\Cref{thm:introextension} is true for $a=1,b=0$ and $X$ a Shimura variety.\n\\end{theorem}\n\\begin{proof}\nWe will prove that the image of $\\Dstar$ lands in a residue disc after suitably shrinking $\\sD$ -- this would yield the theorem. The proof consists of assembling the various results already proved.\n\n We have that $f^* \\bL$ extends to a local system with crystalline fibers on $\\sD$. By Proposition \\ref{prop:existence_of_crystal}, we may shrink $\\sD$ and obtain an $F$-crystal $\\D$ on $\\A^1 \\bmod p$ such that for any classical $y\\in \\sD$, $\\D_{\\cris}(\\bL_y) = \\D_{\\bar{y}}$. By further shrinking $\\sD$, we get that the $F$-crystal $\\D$ is constant, and therefore the isomorphism class of $\\D_{\\cris}(\\bL_y)$ is independent of the point $y$. \n\nLet $\\Ann_n \\subset \\sD$ be a closed annulus with outer radius 1 and inner radius $\\frac1{p^n}$, and let $f_n: \\mathfrak{A}_n \\rightarrow \\integralS$ be an integral model for the map $f|_{\\Ann_n}$. By \\cite[Appendix]{p-adic-borel-Ag}, we have that the special fiber $C$ of $\\mathfrak{A}_n$ is a union of two affine lines and some number of projective lines with trivial combinatorial monodromy. It suffices to show that $f_n|_{C_i}$ is constant for every component $C_i$ of $C$. \n\nLet $\\bar{y} \\in C_i$ and let $y\\in \\mathfrak{A}^{\\rig}_n(K) = \\Ann_n$ be a point that specializes to $\\bar{y}$. We have that $_{\\cris}\\V_{\\bar{y}} \\simeq \\D_{\\cris(\\bL_y)}$ and therefore we have that $f_n^*(_{\\cris}\\V)_{C_i}$ is point-wise constant. Let $\\bar{C}_i$ be the compactification of $C_i$. The map $C_i \\rightarrow \\integralS_p$ extends to $\\bar{C}_i \\rightarrow \\integralS_p$ the results of Section \\ref{Sec: bdry}. Therefore, the $F$-crystal $f_n^*( \\Vcris)|_{C_n}$ extends to an $F$-crystal on $\\bar{C}_i$, and therefore the $F$-isocrystal must be constant -- indeed every $F$-isocrystal on $\\P^1$ is constant. We are now in the situation of a point-wise constant $F$-crystal such that the underlying $F$-isocrystal is constant. By \\autoref{thm: constancy of F-crystal}, we have that $f_n^*( \\Vcris)|_{C_n}$ is constant. The theorem follows by applying \\autoref{prop: constantFLconstantmap}.\n\\end{proof}\n\n\\subsection{Period images}\n%We work with the hypotheses of \\cite[Theorem 4.3]{bst-integral-canonical}. For every $i$, we have resolutions $\\pi_i: S_i \\rightarrow Y_i$ defined over $W$. Therefore, the local system $\\bL_i := \\pi_i^{-1}(\\bL)$ is crystalline (in the sense of Faltings-Fontaine-Laffaile) on $S_i[1/p]$. Let $_{\\cris}\\V_i/S_i \\mod p$ denote the crystal underlying the Fontaine-Laffaile module associated to $\\bL_i$. \n\nWe have the following result. \n\\begin{proposition}\\label{prop: pointwise crystal}\n    Fix some integer $j$ and consider $\\pi^j: S^j \\rightarrow Y^j$. Let $y\\in \\integralY^j(\\Fpbar)$ denote some point and let $\\cF_y \\subset \\cS^j$ denote the fiber over $y$. Then we have that $\\Ucris^j|_{\\cF_y}$ is point-wise constant. Further, the isomorphism class of this crystal is $\\D_{\\cris}({\\VetZp}_{\\tilde{y}})$, where $\\tilde{y} \\in Y(\\cO_K)$ is any lift of $y$. \n\\end{proposition}\n\\begin{remark}\n    Note that this proposition assigns a canonical crystal to every $y\\in \\integralY(\\Fpbar)$. \n\\end{remark}\n\\begin{proof}\n    Let $T(\\cF_y)$ denote the tube in $\\cS^j$ over $\\cF_y$. For any lift $\\tilde{y}$ of $y$, let let $F_{\\tilde{y}} \\subset T(\\cF_y)$ denote the fiber of $\\pi^j$ over $\\tilde{y}$. As the stratification is uniform, there exists a lift $\\tilde{y}$ of $y$, such the specialization map $F_{\\tilde{y}}\\rightarrow \\cF_y$ is surjective. Let $\\tilde{z}\\in T(\\cF_y)$ be any point and let $z\\in \\cF_y(\\Fpbar)$ denote its specialization. As $\\UetZp^j$ is crystalline, we have a canonical isomorphism of crystals $\\D_{\\cris}({\\UetZp^j}_z) \\rightarrow {\\Ucris^j}_{z}$. \n\n    Let $z_i,z_2 \\in \\cF_y$. Let $\\tilde{z}_1$ and $\\tilde{z}_2$ be points in $F_{\\tilde{y}}$ which specialize to $z_1$ and $z_2$ respectively. By the above remark, it suffices to prove that $\\D_{\\cris}({\\UetZp^j}_{\\tilde{z}_1})$ is isomorphic to $\\D_{\\cris}({\\UetZp^j}_{\\tilde{z}_2})$. But this follows directly from the fact that $\\pi^j(\\tilde{z}_1) = \\pi^j(\\tilde{z}_2)$ and that $\\UetZp$ is simply the pull-back of $\\VetZp$ under $\\pi^j$. The proof of the second part now follows from this and the isomorphism $\\D_{\\cris}({\\UetZp^j}_{\\tilde{z}}) \\rightarrow {\\Ucris^j}_z$. \n\n    %Now, suppose that $\\tilde{z}_1, \\tilde{z}_2 \\in T(F_y)$ be two points which specialize to $z_1,z_2 \\in F_y$. Let $\\tilde{z}'_1, \\tilde{z}'_2$ be points on $F_{\\tilde{y}}$ which also specialize to $z_1,z_2$ respectively. By the above remark, it suffices to show that $\\D_{\\cris}(\\bL_{i,\\tilde{z}_1})$ is isomorphic to $\\D_{\\cris}(\\bL_{i,\\tilde{z}_2})$. \n\\end{proof}\n\nWe are now ready to prove the one-dimensional extension theorem in this setting.\n\\begin{theorem}  \n    \\Cref{thm:introextension} is true for $a=1,b=0$ and $X$ a geometric period image.\n\\end{theorem}\n\\begin{proof}\n    As in the Shimura case, we will prove that the image of $\\Dstar$ lands in a residue disc after suitably shrinking $\\sD$. Also as in the Shimura case, we may further shrink $\\Dstar$ such that the isomorphism class of $\\D_{\\cris}(\\bL_y)$ is independent of the point $y\\in \\Dstar$. \n    We let $\\Ann_n$, $\\fA_n$, $f_n$, and $C$ be as in the Shimura case. Pick some component $C_0$ of $C$ isomorphic to $\\P^1$. Suppose that $j$ is the smallest integer such that $f_n(C_0) \\subset \\integralY^j$. Then, we have that $C_0$ generically maps into $\\integralY^j \\setminus \\integralY^{j-1}$ and therefore we may lift $f_n$ to a map $g_n: C_0\\rightarrow \\cS^j$. By \\autoref{prop: pointwise crystal}, we have that $g_n^{*}(\\Ucris^j)$ is point-wise constant. As $C_0$ is isomorphic to to $\\P^1$, we also have that the iso-crystal $g_n^{*}(\\Ucris^j[1/p])$ is constant. By \\autoref{thm: constancy of F-crystal}, we have that $g_n^{*}(\\Ucris^j)$ is constant. As in the Shimura case, it follows that $g_n^{*}(\\UFL^j)$ is trivial as a filtered flat bundle. Up to passing to a finite cover $C'_0$ of $C_0$, we may lift the map $g_n$ to a map $h_n: C'_0 \\rightarrow \\cT^j$. We therefore have that $h_n^{*}(q^{i*}(\\Udr^j))$ is trivial as a filtered flat bundle, as $\\Udr^j$ and $\\UFL^j$ pull back to isomorphic filtered flat bundles on $\\cT^j$. Therefore, the Griffiths bundle is trivial on $C'_0$. If $f_n|_{C_0}$ is non-constant, we also have that Griffiths bundle on $C_0$ associated to $g_n^{*}(\\Udr^j) \\simeq f_n^*(\\Vdr)$ is ample, and therefore the Griffiths bundle must be ample on $C'_0$. This is a contradiction. Therefore, $f_n|_{C_0}$ must be constant. It follows that the map $f_n$ contracts every component isomorphic to $\\P^1$. By \\cite[Appendix Remark A.7]{borel}, it follows that the open subannulus of $\\Ann_n$ maps to a single residue disc. This holds for every $n$, and therefore we have that the open punctured disc maps to a single residue disc. The theorem follows. \n\\end{proof}\n\n\n\n%\\section{Proof of the extension theorem for the boundary in the Shimura case}\n%BOSZ\n\n\n\n\\section{Higher-dimensional extension theorem}\\label{sec: higher borel}\nIn this section, we deduce the higher-dimensional extension theorem from the theorem for $\\Dstar$. \n\n\n\n\\subsection{Preliminaries}We first prove some general statements regarding mermorphic extension.  We will work in the following setting. Let $X$ be a quasi-projective algebraic variety over $K$ with a projective compactification $\\overline{X}$ over $K$. We fix a closed embedding $\\overline{X} \\hookrightarrow \\PP^n_K$ into projective $n$-space. This corresponds to the data of a very ample line bundle on $\\overline{X}$ relative to $K$ that we denote by $\\mathscr{L}$, along with $n+1$ generating global sections $s_0,\\ldots, s_n \\in H^0(\\overline{X},\\mathscr{L})$. \n\n\\begin{definition}\n    We say that the compactification $X \\subset \\overline{X}$ \\emph{satisfies one-dimensional Borel extension over all finite extensions of $K$}, if for any finite field extension $F$ of $K$, every analytic map $g^\\times : \\Dstar_F \\rightarrow (X \\times_K F)^\\an$ over $F$ admits an analytic extension $g : \\sD_F \\rightarrow (\\overline{X} \\times_K F)^\\an$.\n\\end{definition}\n\n\\begin{definition}\n    Let $W,Y$ be reduced rigid analytic spaces and $Z\\subset Y$ a closed subspace.  We say a morphism $f:Y\\backslash Z\\to W$ \\emph{extends meromorphically over $Z$} if the (metric) closure of the graph of $f$ in $Y\\times W$ is an analytic subspace.  Equivalently, there is modification $g:Y'\\to Y$ and a commutative diagram\n    \\[\\begin{tikzcd}\n    &Y'\\ar[ld,\"g\",swap]\\ar[rd]&\\\\\n    Y&&W\\\\\n    &Y\\backslash Z\\ar[lu,\"i\"]\\ar[ru,\"f\"]&\n    \\end{tikzcd}\\]\n    where $i$ is the inclusion.\n\\end{definition}\n\nThe main result of this section is the following, which says that the one-dimensional Borel extension implies that analytic maps from poly-punctured disks $(\\Dstar)^a \\times \\sD^b$ into $X$ extend meromoprhically.\n\\begin{proposition}\\label{extension-to-codim-1}\n    Suppose $X \\subset \\overline{X}$ satisfies one-dimensional Borel extension over all finite extensions of $K$. Then, given any finite field extension $F$ of $K$, and any analytic map $h^\\times : (\\Dstar_F)^a \\times \\sD_F^b \\rightarrow X_F^\\an$, there is a closed analytic subspace $Z \\subset \\sD_F^{a+b}$ of codimension at least $2$ contained in the complement of $(\\Dstar)^a \\times \\sD^b$ such that $h^\\times$ extends to an analytic map $h : \\sD_F^{a+b}\\setminus Z \\rightarrow \\overline{X}_F^\\an$.  Moreover, $h$ extends meromorphically over $Z$.\n\\end{proposition}\n\nWe need two preparatory lemmas first. In \\autoref{triviality-of-pic}, we show that there are no non-trivial line bundles on $(\\Dstar)^a \\times \\sD^b$, and in \\autoref{meromorphicity-from-finiteness}, we prove that an analytic function on $(\\Dstar)^a \\times \\sD^b$, whose restriction to every one-dimensional punctured disk extends meromorphically to the disk $\\sD$, must itself extend meromorphically to $\\sD^{a+b}$.\n\n\n\\begin{lemma}\\label{triviality-of-pic}\nLet $\\Ann_0 := \\Spa(K\\langle z^{\\pm 1} \\rangle, \\cO_K\\langle z^{\\pm 1}\\rangle)$ denote the thin annulus over $K$ at radius 1 centered at 0. Let $a, b, c$ be non-negative integers. Then every line bundle on $(\\Dstar)^a \\times \\sD^b \\times \\Ann_0^c$ is trivial. In particular, every line bundle on $(\\Dstar)^a \\times \\sD^b$ is trivial. \n\\end{lemma}\n\\begin{proof}\n    We induct on $a$ with the base case of $a=0$, being a consequence of the fact that the affinoid algebra $K\\langle t_1,\\ldots,t_b, z_1^{\\pm 1},\\ldots, z_c^{\\pm 1} \\rangle$ is a UFD (see \\cite[Theorem 3.25]{vanderput-cohomology}).\n    Suppose $a \\geq 1$ and $\\mathcal{E}$ is a line bundle on $(\\Dstar)^a \\times \\sD^b \\times \\Ann_0^c$. By the inductive hypothesis, the restriction of $\\mathcal{E}$ to $(\\Dstar)^{a-1} \\times \\Ann_0 \\times \\sD^b \\times \\Ann_0^c$ is trivial. We may thus glue $\\mathcal{E}$ with the trivial line bundle on $(\\Dstar)^{a-1} \\times (\\PP^1_K)^\\an\\setminus \\{|z| < 1\\} \\times \\sD^b \\times \\Ann_0^c$ to obtain a line bundle $\\hat{\\mathcal{E}}$ on $(\\Dstar)^{a-1} \\times \\mathbb{A}^{1,\\an}_K \\times \\sD^b \\times \\Ann_0^c$ that extends $\\mathcal{E}$. By \\cite[Prop. 3.6]{sigloch-homotopy} (see also \\cite[Corollary 5]{kerz-saito-tamme} for the smooth affinoid case), $\\hat{\\mathcal{E}}$ is the pullback of a line bundle on $(\\Dstar)^{a-1} \\times \\sD^b \\times \\Ann_0^c$. However, by the inductive hypothesis every line bundle on $(\\Dstar)^{a-1} \\times \\sD^b \\times \\Ann_0^c$ is trivial and hence so is $\\hat{\\mathcal{E}}$ and therefore so is $\\mathcal{E}.$\n\\end{proof}\n\n\n\\begin{lemma}\\label{meromorphicity-from-finiteness}\n    Let $f(\\underline{z},\\underline{t})$ be an analytic function on $(\\Dstar)^a \\times \\sD^b$, such that for each $1 \\leq i \\leq a$, and each finite extension $F$ of $K$, and every $F$-valued point $P' = (c_1,\\ldots,\\widehat{c_i},\\ldots,c_a,\\underline{\\tau}) \\in (\\Dstar)^{a-1} \\times \\sD^b$, the specialization $f(c_1,\\ldots,z_i,\\ldots,c_a,\\underline{\\tau}) \\in \\cO(\\Dstar_F)$ has only finitely many zeroes on $\\Dstar_F.$ Then $f(\\underline{z},\\underline{t})$ extends to a meromorphic function on $\\sD^{a+b}.$\n\\end{lemma}\n\\begin{proof}\n    Fix $1 \\leq i \\leq a$. To simplify notations, we set $z' = (z_1,\\ldots,\\widehat{z_i},\\ldots,z_n)$. The function $f$ admits a power series development \\[ f(\\underline{z},\\underline{t}) = \\sum_{m \\in \\Z} a_m(z',\\underline{t}) z_i^{m},\\] \n    for analytic functions $a_m(z',\\underline{t}) \\in \\cO((\\Dstar)^{a-1}\\times \\sD^b).$ By the $p$-adic big Picard theorem, since for each specialization $P'$, the function $f(z_i,P')$ has only finitely many zeros in $\\Dstar_F$, we have that for each such $P'$, the function $f(z_i,P')$ cannot have an essential singularity at $z_i=0$. That is to say that $a_m(P') = 0$ for all $m$ sufficiently small. In other words, there is an $m_0 \\in \\Z$ such that $P' \\in V(\\{a_l(z',\\underline{t}) : l \\leq m_0\\}).$\n    This being true for every classical point $P'$, implies that $(\\Dstar)^{a-1}\\times \\sD^b = \\cup_{m \\in \\Z} V(\\{a_l(z',\\underline{t}) : l \\leq m\\})$. By the Baire category theorem, this implies that there is an $m(i) \\in \\Z$ such that for $l < m(i)$, $a_l(z',\\underline{t}) = 0$. In particular, $z_i^{-m(i)} f(\\underline{z},\\underline{t})$, extends analytically across the locus $z_i = 0$ as well. The function $\\prod_{1\\leq j \\leq a} z_j^{-m(j)}f(\\underline{z},\\underline{t})$ thus extends analytically to the complement inside $\\sD^{a+b}$ of the codimension 2 subvariety $\\cup_{1 \\leq r < s \\leq a} V(z_r,z_s).$ Hence by the non-archimedean Hartog extension theorem \\cite{bartenwerfer-hartog}, defines an analytic function on $\\sD^{a+b}.$ This completes the proof.\n\\end{proof}\n\n\n\n\n\\begin{proof}[Proof of \\Cref{extension-to-codim-1}] \n    We may assume that $F = K$. Let $h^\\times : (\\Dstar)^a \\times \\sD^b \\rightarrow X^\\an$ be an analytic map. By \\autoref{triviality-of-pic}, we may pick a trivialization $\\phi : (h^\\times)^*(\\mathscr{L}^\\an) \\xrightarrow{\\sim} \\cO_{(\\Dstar)^a \\times \\sD^b}$ of the pullback line bundle $(h^\\times)^*(\\mathscr{L}^\\an)$.    \n    We let $\\underline{z} := (z_1,\\ldots,z_a)$ denote the coordinates on $(\\Dstar)^a$ and $\\underline{t} := (t_1,\\ldots,t_b)$ the coordinates on $\\sD^b.$\n    Let $f_r(\\underline{z}, \\underline{t}) := \\phi(s_r) \\in \\cO((\\Dstar)^a \\times \\sD^b)$. \n    On classical points $(\\underline{z},\\underline{t}) \\in (\\Dstar)^a \\times \\sD^b$, the map $h^\\times : (\\Dstar)^a \\times \\sD^b \\rightarrow X^\\an \\hookrightarrow \\PP^{n,\\an}_K$ is given in projective coordinates by $[f_0(\\underline{z},\\underline{t}) : \\ldots : f_n(\\underline{z},\\underline{t})].$ For each $i \\in \\{1,\\ldots,a\\}$, and any finite extension $F$ of $K$ and an $F$-valued point $P' = (c_1,\\ldots,\\widehat{c_i},\\ldots, c_a, \\underline{\\tau}) \\in (\\Dstar)^{a-1}\\times \\sD^b$, the analytic map $h^\\times_{P'} : \\Dstar_F \\rightarrow \\PP^{n,\\an}_F$ given by $z_i\\mapsto [f_0(c_1,\\ldots,z_i,\\ldots, c_a,\\underline{\\tau}): \\ldots : f_n(c_1,\\ldots,z_i,\\ldots, c_a,\\underline{\\tau})]$,  by hypothesis extends analytically to a map $h_{P'} : \\sD_F \\rightarrow \\PP^{n,\\an}_F.$ In particular, there exist analytic functions $g_r(z_i) \\in F\\langle z_i \\rangle$ (depending on $P'$) with no common zeroes on $\\sD_F$ such that for all classical points $z_i \\in \\Dstar_F$,  $[f_0(c_1,\\ldots,z_i,\\ldots, c_a,\\underline{\\tau}):\\ldots: f_n(c_1,\\ldots,z_i,\\ldots, c_a,\\underline{\\tau})] = [g_0(z_i):\\ldots : g_n(z_i)]$. This implies that for all $r, s$, $f_r(c_1,\\ldots,z_i,\\ldots, c_a,\\underline{\\tau}) g_s(z_i) = f_s(c_1,\\ldots,z_i,\\ldots, c_a,\\underline{\\tau})g_r(z_i)$ as analytic functions on $\\Dstar_F$ (with coordinate $z_i$). Since the $\\{f_r(c_1,\\ldots,z_i,\\ldots, c_a,\\underline{\\tau})\\}_{0 \\leq r \\leq n}$ and the $\\{g_r(z_i)\\}_{0\\leq r \\leq n}$ have no common zeroes in $\\Dstar_F$, this in particular implies that for each $0 \\leq r \\leq n$, the zero set $V(f_r(c_1,\\ldots,z_i,\\ldots, c_a,\\underline{\\tau}))$ equals $V(g_r(z_i))$ in $\\Dstar_F$ and is thus \\emph{finite}. We conclude from \\autoref{meromorphicity-from-finiteness} that there are non-negative integers $\\{m(j) : 1\\leq j \\leq a\\}$, such that for each $0 \\leq r \\leq n$, $F_r(\\underline{z},\\underline{t}) := \\prod_{1\\leq j \\leq a} z_j^{m(j)} f_r(\\underline{z},\\underline{t})$ extends analytically to $\\sD^{a+b}$ and such that for each $1 \\leq j \\leq a$, there is an $r$ such that $z_j \\nmid F_r(\\underline{z},\\underline{t})$ in $\\cO(\\sD^{a+b})$. The set of common zeroes $Z := V(\\{F_r(\\underline{z},\\underline{t}) : 0 \\leq r \\leq n\\})$ has codimension at least 2 in $\\sD^{a+b}$, and $h^\\times$ extends analytically to the map $h : \\sD^{a+b}\\setminus Z \\rightarrow \\PP_K^{n,\\an},$ given by $(\\underline{z},\\underline{t}) \\mapsto [F_0(\\underline{z},\\underline{t}):\\ldots : F_n(\\underline{z},\n    \\underline{t})].$\n\n    For the final claim, let $V\\subset \\sD^{a+b}\\times \\PP^{n,\\an}_K$ be the subspace cut out by $x_iF_j-x_jF_i$, where the $x_i$ are homogeneous coordinates on $\\PP^n_K$.  This subspace is equal to the graph $\\Gamma$ of $h$ when intersected with $U:=(\\sD^{a+b}\\backslash Z)\\times \\PP^{n,\\an}_K$.  There is therefore an irreducible component $V_0$ of $V$ for which $\\Gamma=U\\cap V_0$ (\\cite[Cor. 2.2.9]{conrad-irreducible-comp}), and since $U\\cap V_0$ is metrically dense in $V_0$, it follows that $V_0$ is the closure of $\\Gamma$.\n\\end{proof}\n\n\n\n\\begin{remark}\n    We remark that the meromorphicity in \\Cref{extension-to-codim-1} is automatic for an analytic morphism defined outside codimension 2, as in the complex analytic case: \n\n\\begin{lemma}\n    Let $Y$ be a smooth connected rigid analytic space and $Z\\subset Y$ a closed subspace of codimension $\\geq 2$.  Then any morphism $f:Y\\backslash Z\\to X^\\an$ extends meromorphically over $Z$. \n\\end{lemma}\n\n\n\\begin{proof}\n    We may assume $X=\\PP^n_K$. Since $Z$ has codimension at least 2 in $Y$, the pull-back $f^\\ast(\\cO(1))$ extends to a line bundle on $Y$ (using the correspondence between line bundles and Weil divisors and applying Remmert-Stein which allows us to extend Weil divisors outside the codimension $\\geq$ 2 analytic subvariety $Z$.) \n    The question of whether $f$ extends meromorphically across $Z$ to all of $Y$ is local on $Y$. We may therefore assume that the pull-back $f^\\ast \\cO(1)$ is trivial. Then the morphism $f : Y\\setminus Z \\rightarrow \\PP^{n,\\an}_K$ is described in homogenous coordinates by $n+1$ analytic functions $y \\mapsto [f_0(y):\\ldots : f_n(y)]$ where $f_i(y) \\in \\cO(Y\\setminus Z)$ do not have any common zeroes in $Y\\setminus Z$. By the non-archimedean Hartog extension theorem, $f_i(y)$ uniquely extend to analytic functions $F_i \\in \\cO(Y)$. The subspace in $Y \\times \\PP^{n,\\an}_K$ cut out by $x_iF_j - x_jF_i$ contains as an irreducible component the closure inside $Y \\times \\PP^{n,\\an}_K$ of the graph of $f : Y \\setminus Z \\rightarrow \\PP^{n,\\an}_K$.   \n\\end{proof}\n\\end{remark}\n\n\n\\subsection{Higher-dimensional extension for Shimura varieties and period images}\n\\def\\Griff{\\operatorname{Griff}}\n\\def\\cU{\\mathcal{U}}\n\\def\\Proj{\\operatorname{Proj}}\n\\def\\Can{{\\C\\mbox{-}\\an}}\nLet $X$ denote either $\\ShimK$ or a geometric period image $Y$ as described in $\\S1$.  For the reader's convenience we summarize here the structures that will be relevant for the proof of \\Cref{thm:introextension}.\n\\begin{itemize}\n\\item A $\\Z_p$-local system $\\VetZp$ on $X$.\n\\item A filtered vector bundle $V_{\\mathrm{dR}}:=(\\mathcal{V},F^\\bullet )$ on $X$.\n\\item A normal compactification $X^\\BB$ of $X$ for which the $k$th (for some $k$) power of the Griffiths bundle\n\\[\\Griff(V_{\\mathrm{dR}}):=\\bigotimes_p\\det F^p\\]\nextends to an ample line bundle $L$.  This is \\cite{bailyborel} in the Shimura variety case and \\cite[Thm 1.2]{bfmt-bailyborel} in the period image case.\n\\item A log smooth proper $(X',D_{X'})$ with a modification $\\pi_{X'\\backslash D_{X'}}:X'\\backslash D_{X'}\\to X$, such that the pullback $U_{\\mathrm{dR}}:=(\\mathcal{U},\\nabla,F^\\bullet)$ of $(\\mathcal{V},F^\\bullet )$ admits a flat connection with respect to which the filtration is Griffiths transverse and extends to a logarithmic flat vector bundle $\\bar U_{\\mathrm{dR}}:=(\\bar{ \\mathcal{U}},\\nabla,F^\\bullet\\bar{\\mathcal{U}})$ such that the eigenvalues of the residues are contained in $[0,1)\\cap \\Q$.  Moreover, $\\pi_{X'\\backslash D_{X'}}:X'\\backslash D_{X'}\\to X$ extends to a morphism $\\pi:(X',D_{X'})\\to (X^\\BB,X^\\BB\\backslash X)$ for which\n\\[\\pi^*L\\cong \\Griff(\\bar U_\\mathrm{dR})^k.\\]\n\nHere, $X'$ is taken to be the largest stratified resolution $S^m$ in the period image case, and $S$ itself in the Shimura variety case.  Again, this follows from \\cite{bailyborel} in the Shimura variety case and \\cite[Thm 1.2]{bfmt-bailyborel} in the period image case. \n\\item We have \n\\begin{equation}\\label{pullback isom}\\bar U_{\\mathrm{dR}}^{\\an}\\cong \\Ddrlog(\\pi_{X'\\backslash D_{X'}}^*\\VetZp) \\end{equation}\nvia the $p$-adic Riemann--Hilbert correspondence of \\cite[Thm 1.7]{DLLZ}.  In the period image case the isomorphism is given over $P'$ by the second part of \\cite[Thm 1.1]{DLLZ}, and in the Shimura variety case by \\cite[Thm 1.5]{DLLZ}.\n\\end{itemize}\n\\begin{proposition}  Let $(M,D_M)$ be a log smooth rigid-analytic variety and $f:M\\backslash D_M\\to X^\\an$ a morphism such that $M\\backslash D_M\\to X^{\\BB,\\an}$ extends meromorphically over $D_M$.  Then it extends regularly over $D_M$.\n\\end{proposition}\n\\begin{proof}By meromorphicity and embedded resolution of singularities \\cite[Thms 1.1.9, 1.1.13]{temkinembedded}, there is a log smooth $(M',D_{M'})$, a modification $g:(M',D_{M'})\\to (M,D_M)$, and a diagram\n\\[\n\\begin{tikzcd}\n    &(M',D_{M'})\\ar[dd,\"g\"]\\ar[rr,\"h\"]&&(X',D_{X'})\\ar[dd,\"\\pi\"]\\\\\n    M'\\backslash D_{M'}\\ar[dd,\"g_{M'\\backslash D_{M'}}\"]\\ar[ru]&&\\\\\n    &(M,D_M)&&(X^\\BB,X^\\BB\\backslash X)\\\\\n    M\\backslash D_M\\ar[ru]\\ar[rr,\"f\"]&&X\\ar[ru]&\n\\end{tikzcd}\n\\]\nSince $(\\pi h)_{M'\\backslash D_{M'}}^*\\V\\cong (fg_{M'\\backslash D_{M'}})^*\\VetZp$, we have \n\\[g^*\\Ddrlog(f^*\\VetZp)\\cong h^*\\Ddrlog(\\pi_{X'\\backslash D_{X'}}^*\\VetZp) \\]\nand likewise for the Griffiths bundles.  Since $\\Griff(\\Ddrlog(\\pi_{S'\\backslash D_{S'}}^*\\VetZp))^k$ descends amply to $X^\\BB$, it follows that $\\pi h$ factors through $g$, by the rigidity lemma (see e.g. \\cite[Lemma 1.15]{debarre}).\n\\end{proof}\n\\begin{comment}\n\\subsubsection{Period images}\n\nWe summarize here the relevant structures that are present on a period image.\n\nLet $f:X\\to T$ be a smooth projective morphism defined over a number field $K\\subset \\C$ with $T$ smooth, and consider the variation of Hodge structures with underlying local system $V_\\Z:=R^k(f^\\Can)_*\\Z_{X^\\Can}$ with respect to the complex analytification.  We assume $V_\\Z$ has neat monodromy, which will always be the case after base-change to a finite \\'etale cover.  Associated to $V_\\Z$ we have a filtered flat vector bundle $(V,\\nabla,F^\\bullet V)$ defined over $K$ for which $V_\\C\\cong (V^{\\Can})^\\nabla$.  There is a period map $\\phi:T^\\Can\\to \\Gamma\\backslash \\D$ which by \\cite{} factors through a morphism $g:T\\to S$ where $S$ is the normalization of the closure of the image of $\\phi$ in the function field of $T$.  Moreover, up to replacing $K$ with a finite extension, we have:\n\\begin{itemize}\n\\item $S$ and $g$ are defined over $K$.\n\\item $(V,\\nabla,F^\\bullet V)$ descends to $(U,\\nabla, F^\\bullet U)$ on $S$, which is also defined over $K$.\n\\item $V_\\Z$ descends to $U_\\Z$ on $S^\\Can$ with $U_\\C\\cong (U^\\Can)^\\nabla$.\n\\item For a log smooth proper $(S',D_{S'})$ defined over $K$ with a modification $\\pi_{S'\\backslash D_{S'}}:S'\\backslash D_{S'}\\to S$, the pullback $(U',\\nabla,F^\\bullet U')$ of $(U,\\nabla,F^\\bullet U)$ extends to a logarithmic flat vector bundle $\\mathbf{\\bar U}':=(\\bar U',\\nabla,F^\\bullet \\bar U')$, also defined over $K$.\n\\item The Griffiths bundle \n\\[L':=\\Griff(\\mathbf{\\bar U}'):=\\bigotimes_p\\det F^p\\bar U'\\]\nis semiample, and $S^\\BB:=\\Proj \\bigoplus_k H^0(S',L'^k)$ is a projective compactification of $S$ defined over $K$ to which $\\Griff(\\mathbf{U})$ extends amply (to $\\cO_{S^\\BB}(1)$).\n\\item For each finite place $v|p$ of $K$, a $\\Q_p$-local system $\\bL$ on $S$.  Moreover, we have \\begin{equation}\\label{pullback isom}\\mathbf{\\bar U}'^{\\an}\\cong \\Ddrlog(\\pi_{S'\\backslash D_{S'}}^*\\bL) . \\end{equation}\nIndeed, up to a modification of $T$ we may assume there is a log smooth compactification $(T',D_{T'})$ of $T$ for which $g:T\\to S$ factors through $g':(T',D_{T'})\\to (S',D_{S'})$.  The identification \\eqref{pullback isom} holds on $T$ and therefore $T'$, hence also on $S'$, since both sides descend to $S'$ and $g'$ has geometrically connected fibers.  In particular, $\\Griff(\\Ddrlog(\\pi_{S'\\backslash D_{S'}}^*\\bL))$ descends amply to $S^\\BB$.\n\\end{itemize}\n\n\nLet $S/K$ be either a Shimura variety or a variety with a geometric period image and $S^{\\BB}$ its Baily--Borel compactification.  Let $S^{\\BB,\\an}$ be its analytification at some finite place $v$. \n\n{\\color{red}\n\\begin{lemma}\\label{lem: Griffiths = RH} With the above notation we have\n$$\\pi^*\\cO_{S^{\\BB}}(n)\\cong \\Griff(\\RH_{\\log}(\\pi^*\\bL))^n$$ for sufficiently divisible $n$.  \n\\end{lemma}\n\\begin{proof}From \\eqref{pullback isom} we have\n\\[\\sigma_*\\cO\\otimes \\mathbf{\\bar U}'^{\\an}\\cong \\sigma_*\\cO\\otimes \\RH_{\\log}(\\pi^*\\bL)\\]\nas filtered flat vector bundles, at least outside codimension 2.  Taking determinants yields the claim.\n\\end{proof}\n}\n\n\n\n{\\color{blue}\n\\begin{proposition}  Let $(Y,D_Y)$ be a log smooth rigid-analytic variety and $f:Y\\backslash D_Y\\to S^\\an$ a morphism such that $Y\\backslash D_Y\\to S^{\\BB,\\an}$ extends meromorphically over $D_Y$.  Then it extends regularly over $D_Y$.\n\\end{proposition}\n\\begin{proof}By meromorphicity and embedded resolution of singularities \\cite{}, there is a log smooth $(X,D_X)$, a modification $g:(X,D_X)\\to (Y,D_Y)$, and a diagram\n\\[\n\\begin{tikzcd}\n    &(X,D_X)\\ar[dd,\"g\"]\\ar[rr,\"h\"]&&(S',D_{S'})\\ar[dd,\"\\pi\"]\\\\\n    X\\backslash D_X\\ar[dd,\"g_{X\\backslash D_X}\"]\\ar[ru]&&\\\\\n    &(Y,D_Y)&&(S^\\BB,S^\\BB\\backslash S)\\\\\n    Y\\backslash D_Y\\ar[ru]\\ar[rr,\"f\"]&&S\\ar[ru]&\n\\end{tikzcd}\n\\]\nSince $(\\pi h)_{X\\backslash D_X}^*\\bL\\cong (fg_{X\\backslash D_X})^*\\bL$, we have \n\\[g^*\\Ddrlog(f^*\\bL)\\cong h^*\\Ddrlog(\\pi_{S'\\backslash D_{S'}}^*\\bL) \\]\nand likewise for the Griffiths bundles.  Since $\\Griff(\\Ddrlog(\\pi_{S'\\backslash D_{S'}}^*\\bL))$ descends amply to $S^\\BB$, it follows that $\\pi h$ factors through $g$.\n\\end{proof}\n}\n\\begin{proposition}\n    Let $Y$ be a smooth rigid-analytic variety, $Z\\subset Y$ a closed subvariety of codimension $\\geq 2$, and $f:Y\\backslash Z\\to S^{\\BB,\\an}$ an analytic morphism which extends meromorphically over $Z$.  Then it extends regularly over $Z$.  \n\\end{proposition}\n\\begin{proof}\nThe boundary of $S^{\\BB,\\an}$ is stratified by locally closed subvarieties each of which is either a Shimura variety or a variety with quasifinite geometric period map. So, we may assume without any loss in generality that the image of $f$ is generically contained in the interior of $S^{\\BB}$. Let $Y_0\\subset Y \\setminus Z$ denote the locus that maps to the interior $S$, and let $f_0 = f|_{Y_0}$. We may resolve $Y\\dashrightarrow S^{\\BB,\\an}$ to a map $f': Y'\\setminus Z' \\dashrightarrow S'$ which extends meromorphically over $Z'$.  We may assume that $Z'$ is a closed subvariety of codimension $\\geq 2$. We now may further resolve to obtain a map $g: X' \\rightarrow S'$. Let $X'_0 \\subset X'$ denote the locus of $X'$ that maps to interior of $S'$ and let $g_0 = g|_{X'_0}$. Let $\\pi_1: X'\\rightarrow Y$ denote the tautological map.  \n\n\nWe abuse notation and let $\\bL$ denote the local system on $S'$ pulled back from $S$. By Lemma \\ref{lem: Griffiths = RH}, we may assume that the pull-back of Griffiths bundle to $S'$ is the same as the pull-back of the Griffiths bundle associated to $\\RH(\\bL)$. We now pull this line bundle to $X'$, and claim that it is a torsion line bundle on the fibers of $\\pi_1$. Indeed, upto raising to a high enough power, the pull-back of the Griffiths bundle to $X'$ is isomorphic to the Griffiths bundle attached to $\\RH(g_0^*(\\bL))$ (which is a filtered bundle with log connection). However, $g_0^* \\bL = \\pi_1^* f_0^* \\bL$, and therefore we have that $\\RH(g_0^*(\\bL)) \\simeq \\pi_1^* \\RH(f_0^* \\bL)$. The claim follows. \n\nConsider any $y\\in Y$ and let $F_y := \\pi_1^{-1}(\\{y\\}) \\subset X'$. By the discussion above, we have that $g^*\\pi^* \\cO_{S^{\\BB}}(n)|_{F_y}$ is trivial. As $\\cO_{S^{BB}}(n)$ is ample on $S^{\\BB}$, it follows that the map $g\\circ \\pi: F_y \\rightarrow S^{\\BB}$ is constant. Therefore, the map $X'\\rightarrow S^{\\BB}$ is constant on the fibers of $\\pi_1$, and therefore descends to a map $Y\\rightarrow S^{\\BB}$ as required. \n\n\\end{proof}\n\\end{comment}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\\bibliographystyle{alpha}\n\\bibliography{main}\n\\end{document}\n\n\n\n\n\n\n\n\n% 1. Thin annulus: OSZP\n\n%2. Similar to OSZP, enough to show every map from Gm mod p extends to punctures. For %this, enough to show that local monodromy around punctures is semisimple by Lemma NOS. \n\n%3. By Deligne Weil 2, enough to show that the local system is point-wise pure. \n\n%4. In the SV case, can assume the local system is irreducible on SV with finite %determinant. Then Drinfeld / Laffaurge give point-wise purity. In the period image case, %local system arises from geometry and so Deligne Weil 2 gives point-wise purity. ",
  "main_tex_file": "main.tex",
  "saved_at": "2025-10-02T04:04:41.813673"
}